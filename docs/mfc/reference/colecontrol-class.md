---
title: Classe COleControl | Microsoft Docs
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- OLE controls, MFC
- windowless controls, MFC
- windowless controls
- controls [MFC], OLE
- controls [MFC], windowless
- COleControl class
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
caps.latest.revision: 25
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: a82768750e6a7837bb81edd8a51847f83c294c20
ms.openlocfilehash: 1f6eeb9802636ebf78f7e5d0b20a188e08a903a6
ms.lasthandoff: 04/04/2017

---
# <a name="colecontrol-class"></a>Classe COleControl
Uma classe base poderosa para o desenvolvimento de controles OLE.  
  
## <a name="syntax"></a>Sintaxe  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>Membros  
  
### <a name="public-constructors"></a>Construtores públicos  
  
|Nome|Descrição|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|Cria um objeto `COleControl`.|  
  
### <a name="public-methods"></a>Métodos públicos  
  
|Nome|Descrição|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|Recupera a aparência atual do controle.|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|Retorna o valor da propriedade BackColor ambiente.|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Retorna o nome do controle conforme especificado pelo contêiner.|  
|[COleControl::AmbientFont](#ambientfont)|Retorna o valor da propriedade de fonte de ambiente.|  
|[COleControl::AmbientForeColor](#ambientforecolor)|Retorna o valor da propriedade ForeColor ambiente.|  
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Retorna a ID de localidade. do contêiner|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Retorna o tipo de unidades usadas pelo contêiner.|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Determina se os identificadores de captura devem ser exibidos.|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Determina se a hachura deve ser exibida.|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|Retorna o tipo de alinhamento de texto especificado pelo contêiner.|  
|[COleControl::AmbientUIDead](#ambientuidead)|Determina se o controle deve responder às ações de interface do usuário.|  
|[COleControl::AmbientUserMode](#ambientusermode)|Determina o modo do contêiner.|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Notifica o contêiner que uma propriedade associada foi alterada.|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Solicita permissão para editar o valor da propriedade.|  
|[COleControl::ClientToParent](#clienttoparent)|Converte um ponto em relação a origem do controle de um ponto em relação a origem do respectivo contêiner.|  
|[COleControl::ClipCaretRect](#clipcaretrect)|Ajusta um retângulo de cursor se ele é sobreposto por um controle.|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|Chame essa função depois que o conjunto de mnemônicos tratados pelo controle foi alterado.|  
|[COleControl::DisplayError](#displayerror)|Exibe eventos de erro de estoque ao usuário do controle.|  
|[COleControl::DoClick](#doclick)|Implementação das ações `DoClick` método.|  
|[COleControl::DoPropExchange](#dopropexchange)|Serializa as propriedades de um `COleControl` objeto.|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Redesenha a um controle OLE que tenha sido derivado de um controle do Windows.|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Habilita o suporte de quadro simples para um controle.|  
|[COleControl::ExchangeExtent](#exchangeextent)|Serializa a largura e a altura do controle.|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializa as propriedades de estoque do controle.|  
|[COleControl::ExchangeVersion](#exchangeversion)|Serializa o número de versão do controle.|  
|[COleControl::FireClick](#fireclick)|Dispara o estoque `Click` eventos.|  
|[COleControl::FireDblClick](#firedblclick)|Dispara o estoque `DblClick` eventos.|  
|[COleControl::FireError](#fireerror)|Dispara o estoque `Error` eventos.|  
|[COleControl::FireEvent](#fireevent)|Dispara um evento personalizado.|  
|[COleControl::FireKeyDown](#firekeydown)|Dispara o estoque `KeyDown` eventos.|  
|[COleControl::FireKeyPress](#firekeypress)|Dispara o estoque `KeyPress` eventos.|  
|[COleControl::FireKeyUp](#firekeyup)|Dispara o estoque `KeyUp` eventos.|  
|[COleControl::FireMouseDown](#firemousedown)|Dispara o estoque `MouseDown` eventos.|  
|[COleControl::FireMouseMove](#firemousemove)|Dispara o estoque `MouseMove` eventos.|  
|[COleControl::FireMouseUp](#firemouseup)|Dispara o estoque `MouseUp` eventos.|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|Dispara um evento quando o estado pronto do controle é alterado.|  
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Altera o comportamento de ativação padrão de um controle que oferece suporte a `IPointerInactive` interface.|  
|[COleControl::GetAmbientProperty](#getambientproperty)|Retorna o valor da propriedade de ambiente especificada.|  
|[COleControl::GetAppearance](#getappearance)|Retorna o valor da propriedade Appearance estoque.|  
|[COleControl::GetBackColor](#getbackcolor)|Retorna o valor da propriedade BackColor estoque.|  
|[COleControl::GetBorderStyle](#getborderstyle)|Retorna o valor da propriedade BorderStyle estoque.|  
|[COleControl::GetCapture](#getcapture)|Determina se um objeto de controle sem janelas, ativado tem a captura do mouse.|  
|[COleControl::GetClassID](#getclassid)|Recupera a ID de classe OLE do controle.|  
|[COleControl::GetClientOffset](#getclientoffset)|Recupera a diferença entre o canto superior esquerdo da área retangular do controle e o canto superior esquerdo de sua área cliente.|  
|[COleControl::GetClientRect](#getclientrect)|Recupera o tamanho da área do cliente do controle.|  
|[COleControl::GetClientSite](#getclientsite)|Consultas de um objeto para o ponteiro para seu site do cliente atual dentro do respectivo contêiner.|  
|[COleControl::GetControlFlags](#getcontrolflags)|Recupera as configurações de sinalizador de controle.|  
|[COleControl::GetControlSize](#getcontrolsize)|Retorna a posição e o tamanho do controle OLE.|  
|[COleControl::GetDC](#getdc)|Fornece um meio para um controle sem janelas para obter um contexto de dispositivo de seu contêiner.|  
|[COleControl::GetEnabled](#getenabled)|Retorna o valor da propriedade Enabled ações.|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|Recupera um ponteiro para um objeto de controle estendido que pertence ao contêiner.|  
|[COleControl::GetFocus](#getfocus)|Determina se o controle tem o foco.|  
|[COleControl::GetFont](#getfont)|Retorna o valor da propriedade Font estoque.|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Retorna as métricas de um `CFontHolder` objeto.|  
|[COleControl::GetForeColor](#getforecolor)|Retorna o valor da propriedade ForeColor estoque.|  
|[COleControl::GetHwnd](#gethwnd)|Retorna o valor da propriedade hWnd de estoque.|  
|[COleControl::GetMessageString](#getmessagestring)|Fornece o texto da barra de status para um item de menu.|  
|[COleControl::GetNotSupported](#getnotsupported)|Impede o acesso ao valor de propriedade do controle do usuário.|  
|[COleControl::GetReadyState](#getreadystate)|Retorna o estado de preparação do controle.|  
|[COleControl::GetRectInContainer](#getrectincontainer)|Retorna o retângulo de controle em relação ao respectivo contêiner.|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Retorna as métricas da propriedade Font estoque.|  
|[COleControl::GetText](#gettext)|Retorna o valor da propriedade Text ou Caption estoque.|  
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Substitua para permitir que um controle sem janelas ser o destino de arrastar e soltar operações.|  
|[COleControl::InitializeIIDs](#initializeiids)|Informa a classe base das IIDs o controle usará.|  
|[COleControl::InternalGetFont](#internalgetfont)|Retorna um `CFontHolder` objeto para a propriedade de fonte de estoque.|  
|[COleControl::InternalGetText](#internalgettext)|Recupera a propriedade de estoque legenda ou texto.|  
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Define o estado de preparação do controle e dispara o evento de alteração de estado pronto.|  
|[COleControl::InvalidateControl](#invalidatecontrol)|Invalida a uma área do controle exibido, fazendo com que ele seja redesenhado.|  
|[COleControl::InvalidateRgn](#invalidatergn)|Invalida a área de cliente da janela do contêiner em determinada região. Pode ser usado para redesenhar a controles sem janelas na região.|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Permite o carregamento especializado de um controle OLE.|  
|[COleControl::IsModified](#ismodified)|Determina se o estado do controle é alterado.|  
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Indica se o contêiner suporta desenho otimizado para a operação atual de desenho.|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Chamado para determinar se o controle subdivide um Windows controla.|  
|[COleControl::Load](#load)|Redefine quaisquer dados assíncronos anteriores e inicia uma nova carga de propriedade assíncrona do controle.|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Determina se o controle pode ser desativado pelo contêiner.|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Chamado quando uma propriedade de ambiente é alterada.|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Chamado quando a estoque propriedade Appearance é alterada.|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Chamado quando a propriedade de estoque BackColor é alterada.|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Chamado quando a propriedade de estoque BorderStyle é alterada.|  
|[COleControl::OnClick](#onclick)|Chamado para acionar o estoque, clique em eventos.|  
|[COleControl::OnClose](#onclose)|Notifica o controle que `IOleControl::Close` foi chamado.|  
|[COleControl::OnDoVerb](#ondoverb)|Chamado depois que um verbo de controle foi executado.|  
|[COleControl::OnDraw](#ondraw)|Chamado quando um controle é solicitado para redesenhado.|  
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Chamado pelo contêiner quando um controle é solicitado para redesenhado usando um contexto de dispositivo de metarquivo.|  
|[COleControl::OnEdit](#onedit)|Chamado pelo contêiner para ativar a interface do usuário de um controle OLE.|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|Chamado quando o estoque de propriedade Enabled é alterado.|  
|[COleControl::OnEnumVerbs](#onenumverbs)|Chamado pelo contêiner para enumerar os verbos do controle.|  
|[COleControl::OnEventAdvise](#oneventadvise)|Chamado quando os manipuladores de eventos estão conectados ou desconectados de um controle.|  
|[COleControl::OnFontChanged](#onfontchanged)|Chamado quando a estoque propriedade Font é alterada.|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Chamado quando a propriedade de estoque ForeColor é alterada.|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|Chamado quando eventos de um controle estão congelados ou descongelados.|  
|[COleControl::OnGetColorSet](#ongetcolorset)|Notifica o controle que `IOleObject::GetColorSet` foi chamado.|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Fornece informações mnemônicos ao contêiner.|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Chamado para obter uma cadeia de caracteres para representar um valor de propriedade.|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Solicita o identificador do menu de controle que será mesclado com o menu de contêiner.|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Substitua para recuperar o tamanho de exibição do controle mais próximo para o modo de tamanho e a extensão proposto.|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Retorna as cadeias de caracteres que representa os valores possíveis para uma propriedade.|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Retorna o valor correspondente a uma cadeia de caracteres predefinida.|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|Substitua para recuperar o tamanho das áreas de exibição do controle (pode ser usado para habilitar o desenho de dois passos).|  
|[COleControl::OnGetViewRect](#ongetviewrect)|Substituição para converter o tamanho do controle em um retângulo que começa em uma posição específica.|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Substituição para recuperar o status do modo de exibição do controle.|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|Chamado pelo contêiner quando o controle é desativado pela IU.|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Substituição para o contêiner para o controle inativo sob a expedição de ponteiro de mouse ter `WM_MOUSEMOVE` mensagens para o controle.|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Substituição para o contêiner para o controle inativo sob a expedição de ponteiro de mouse ter `WM_SETCURSOR` mensagens para o controle.|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Chamado depois que o evento KeyDown estoque foi acionado.|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Chamado depois que o evento KeyPress estoque foi acionado.|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Chamado depois que o evento KeyUp estoque foi acionado.|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Indica qual página de propriedade a ser usado para editar uma propriedade.|  
|[COleControl::OnMnemonic](#onmnemonic)|Chamado quando uma tecla mnemônica do controle foi pressionada.|  
|[COleControl::OnProperties](#onproperties)|Chamado quando o verbo de "Propriedades" do controle foi invocado.|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Substitua a consulta se a exibição de um controle se sobrepõe a um determinado ponto.|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Substitua a consulta se qualquer ponto em um retângulo especificado se sobrepõe a exibição do controle.|  
|[COleControl::OnRenderData](#onrenderdata)|Chamado pelo framework para recuperar dados no formato especificado.|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|Chamado pelo framework para recuperar dados de um arquivo no formato especificado.|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Chamado pelo framework para recuperar dados de memória global no formato especificado.|  
|[COleControl::OnResetState](#onresetstate)|Redefine as propriedades de um controle com os valores padrão.|  
|[COleControl::OnSetClientSite](#onsetclientsite)|Notifica o controle que `IOleControl::SetClientSite` foi chamado.|  
|[COleControl::OnSetData](#onsetdata)|Substitui os dados do controle com outro valor.|  
|[COleControl::OnSetExtent](#onsetextent)|Chamado depois que a extensão do controle é alterado.|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Chamado após tem sido alterados dimensões do controle.|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|Chamado quando o controle foi ativado pela IU.|  
|[COleControl::OnTextChanged](#ontextchanged)|Chamado quando o texto de estoque ou a propriedade de legenda é alterada.|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Processa as mensagens de janela (diferente de mensagens de teclado e mouse) para controles sem janelas.|  
|[COleControl::ParentToClient](#parenttoclient)|Converte um ponto em relação a origem do contêiner para um ponto em relação a origem do controle.|  
|[COleControl::PostModalDialog](#postmodaldialog)|Notifica o contêiner que uma caixa de diálogo modal foi fechada.|  
|[COleControl::PreModalDialog](#premodaldialog)|Notifica o contêiner que uma caixa de diálogo modal está prestes a ser exibido.|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Destrói e recria a janela do controle.|  
|[COleControl::Refresh](#refresh)|Força um redesenho da aparência do controle.|  
|[COleControl::ReleaseCapture](#releasecapture)|Libera a captura do mouse.|  
|[COleControl::ReleaseDC](#releasedc)|Libera o contexto de dispositivo de exibição de um contêiner de um controle sem janelas.|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Redefine o pai da janela do controle.|  
|[COleControl::ResetStockProps](#resetstockprops)|Inicializa `COleControl` stock propriedades com seus valores padrão.|  
|[COleControl::ResetVersion](#resetversion)|Inicializa o número de versão para um determinado valor.|  
|[COleControl::ScrollWindow](#scrollwindow)|Permite que um controle sem janelas rolar uma área dentro de sua imagem ativa no local na tela.|  
|[COleControl::SelectFontObject](#selectfontobject)|Seleciona uma propriedade de fonte personalizada em um contexto de dispositivo.|  
|[COleControl::SelectStockFont](#selectstockfont)|Seleciona a propriedade Font estoque em um contexto de dispositivo.|  
|[COleControl::SerializeExtent](#serializeextent)|Serializa ou inicializa o espaço de exibição para o controle.|  
|[COleControl::SerializeStockProps](#serializestockprops)|Serializa ou inicializa o `COleControl` propriedades de estoque.|  
|[COleControl::SerializeVersion](#serializeversion)|Serializa ou inicializa as informações de versão do controle.|  
|[COleControl::SetAppearance](#setappearance)|Define o valor da propriedade Appearance estoque.|  
|[COleControl::SetBackColor](#setbackcolor)|Define o valor da propriedade BackColor estoque.|  
|[COleControl::SetBorderStyle](#setborderstyle)|Define o valor da propriedade BorderStyle estoque.|  
|[COleControl::SetCapture](#setcapture)|Faz com que a janela do controle recipiente tomar posse da captura do mouse no nome do controle.|  
|[COleControl::SetControlSize](#setcontrolsize)|Define a posição e o tamanho do controle OLE.|  
|[COleControl::SetEnabled](#setenabled)|Define o valor da propriedade Enabled ações.|  
|[COleControl::SetFocus](#setfocus)|Faz com que a janela do controle recipiente tomar posse do foco de entrada em nome do controle.|  
|[COleControl::SetFont](#setfont)|Define o valor da propriedade Font estoque.|  
|[COleControl::SetForeColor](#setforecolor)|Define o valor da propriedade ForeColor estoque.|  
|[COleControl::SetInitialSize](#setinitialsize)|Define o tamanho de um controle OLE quando exibida pela primeira vez em um contêiner.|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Altera o estado modificado de um controle.|  
|[COleControl::SetNotPermitted](#setnotpermitted)|Indica que uma solicitação de edição falhou.|  
|[COleControl::SetNotSupported](#setnotsupported)|Impede a modificação de valor de propriedade do controle do usuário.|  
|[COleControl::SetRectInContainer](#setrectincontainer)|Define o retângulo de controle em relação ao respectivo contêiner.|  
|[COleControl::SetText](#settext)|Define o valor da propriedade Text ou Caption estoque.|  
|[COleControl::ThrowError](#throwerror)|Indica que ocorreu um erro em um controle OLE.|  
|[COleControl::TransformCoords](#transformcoords)|Transformações coordenam os valores entre um contêiner e o controle.|  
|[COleControl::TranslateColor](#translatecolor)|Converte um **OLE_COLOR** valor para um **COLORREF** valor.|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Determina se as propriedades de ambiente estará disponíveis na próxima vez que o controle é carregado.|  
|[COleControl::WindowProc](#windowproc)|Fornece um procedimento do Windows para uma `COleControl` objeto.|  
  
### <a name="protected-methods"></a>Métodos Protegidos  
  
|Nome|Descrição|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|Chamado pelo framework quando a aparência do controle precisa ser atualizado.|  
|[COleControl::DrawMetafile](#drawmetafile)|Chamado pelo framework quando o contexto de dispositivo de metarquivo está sendo usado.|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Permite a invocação de método de automação.|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Chamado pelo framework para inicializar a lista de formatos de dados suportados pelo controle.|  
  
## <a name="remarks"></a>Comentários  
 Derivado `CWnd`, essa classe herda todas as funcionalidades de um objeto de janela do Windows mais funcionalidades adicionais específicas para OLE, como o acionamento do evento e a capacidade de dar suporte a métodos e propriedades.  
  
 Controles OLE podem ser inseridos em aplicativos de contêiner OLE e se comunicar com o contêiner usando um sistema bidirecional de acionamento do evento e expõe métodos e propriedades para o contêiner. Observe que os contêineres OLE padrão só oferecem suporte a funcionalidade básica de um controle OLE. Eles são capazes de dar suporte a recursos estendidos de um controle OLE. Acionamento de evento ocorre quando eventos são enviados para o contêiner como resultado de determinadas ações que ocorrem no controle. Por sua vez, o contêiner se comunica com o controle por meio de um conjunto de métodos e propriedades análogas às funções de membro de exposto e membros de dados de uma classe do C++. Essa abordagem permite que o desenvolvedor controlar a aparência do controle e notificar o contêiner quando ocorrem determinadas ações.  
  
## <a name="windowless-controls"></a>Controles sem janela  
 Controles OLE podem ser usado ativo no local sem uma janela. Controles sem janela tem vantagens significativas:  
  
-   Controles sem janela podem ser transparente e não retangular  
  
-   Controles sem janelas reduzem o tempo de criação e o tamanho de instância do objeto  
  
 Controles não precisam de uma janela. Serviços que oferece uma janela facilmente podem ser fornecidos por meio de uma única janela compartilhada (geralmente do contêiner) e um pouco de expedição de código. Ter uma janela é principalmente um complicativo desnecessário no objeto.  
  
 Quando a ativação sem janelas for usada, o contêiner (que têm uma janela) é responsável por fornecer serviços caso contrário, terá sido fornecidos pela janela do controle. Por exemplo, se o seu controle precisa consultar o foco do teclado, consulte a captura do mouse ou obter um contexto de dispositivo, essas operações são gerenciadas pelo contêiner. O `COleControl` [funções de membro de operação sem janelas](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) invocar essas operações no contêiner.  
  
 Quando a ativação sem janelas é habilitada, os delegados do contêiner mensagens para o controle de entrada `IOleInPlaceObjectWindowless` interface (uma extensão de [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) para suporte sem janelas). `COleControl`da implementação dessa interface enviará essas mensagens pelo mapa de mensagem do controle, depois de ajustar o mouse coordena adequadamente. Você pode processar essas mensagens como mensagens de janela comum, adicionando as entradas correspondentes no mapa de mensagem.  
  
 Em um controle sem janelas, você sempre deve usar o `COleControl` funções de membro em vez de correspondente `CWnd` funções de membro ou as funções de API do Windows relacionadas.  
  
 Objetos de controle OLE também podem criar uma janela somente quando se tornarem ativos, mas aumenta a quantidade de trabalho necessário para a transição inativo ativo e a velocidade da transição é desativado. Há casos em que esse é um problema: por exemplo, considere uma grade de caixas de texto. Quando o cursor para cima e para baixo pela coluna, cada controle deve ser local ativado e desativado, em seguida. A velocidade da transição inativo/ativo irá afetar diretamente a velocidade de rolagem.  
  
 Para obter mais informações sobre o desenvolvimento de uma estrutura de controle OLE, consulte os artigos [controles ActiveX MFC](../../mfc/mfc-activex-controls.md) e [visão geral: Criando um programa de controle ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Para obter informações sobre como otimizar controles OLE, incluindo controles sem janelas e cintilação, consulte [controles ActiveX MFC: otimização](../../mfc/mfc-activex-controls-optimization.md).  
  
## <a name="inheritance-hierarchy"></a>Hierarquia de herança  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>Requisitos  
 **Cabeçalho:** afxctl. h  
  
##  <a name="ambientbackcolor"></a>COleControl::AmbientBackColor  
 Retorna o valor da propriedade BackColor ambiente.  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O valor atual do contêiner ambiente BackColor propriedade, se houver. Se não há suporte para a propriedade, essa função retorna a cor de plano de fundo do Windows definidos pelo sistema.  
  
### <a name="remarks"></a>Comentários  
 A propriedade BackColor ambiente está disponível para todos os controles e é definida pelo contêiner. Observe que o contêiner não é necessário para dar suporte a essa propriedade.  
  
##  <a name="ambientdisplayname"></a>COleControl::AmbientDisplayName  
 O nome que do contêiner foi atribuído ao controle pode ser usado em mensagens de erro exibidas para o usuário.  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O nome do controle OLE. O padrão é uma cadeia de caracteres de comprimento zero.  
  
### <a name="remarks"></a>Comentários  
 Observe que o contêiner não é necessário para dar suporte a essa propriedade.  
  
##  <a name="ambientfont"></a>COleControl::AmbientFont  
 Retorna o valor da propriedade de fonte de ambiente.  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Um ponteiro para a interface de expedição de fonte de ambiente do contêiner. O valor padrão é **nulo**. Se o retorno não é igual a **nulo**, você é responsável pela liberação fonte chamando seu [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms682317) função de membro.  
  
### <a name="remarks"></a>Comentários  
 A propriedade de fonte de ambiente é definido pelo contêiner e disponível para todos os controles. Observe que o contêiner não é necessário para dar suporte a essa propriedade.  
  
##  <a name="ambientforecolor"></a>COleControl::AmbientForeColor  
 Retorna o valor da propriedade ForeColor ambiente.  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O valor atual do contêiner ambiente ForeColor propriedade, se houver. Se não houver suporte, essa função retorna a cor do texto definido pelo sistema Windows.  
  
### <a name="remarks"></a>Comentários  
 A propriedade ForeColor ambiente está disponível para todos os controles e é definida pelo contêiner. Observe que o contêiner não é necessário para dar suporte a essa propriedade.  
  
##  <a name="ambientlocaleid"></a>COleControl::AmbientLocaleID  
 Retorna a ID de localidade. do contêiner  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O valor da propriedade de identificação de localidade do contêiner, se houver. Se não há suporte para essa propriedade, essa função retornará 0.  
  
### <a name="remarks"></a>Comentários  
 O controle pode usar a identificação de localidade para adaptar sua interface do usuário para localidades específicas. Observe que o contêiner não é necessário para dar suporte a essa propriedade.  
  
##  <a name="ambientappearance"></a>COleControl::AmbientAppearance  
 Recupera a configuração atual de aparência para o objeto de controle.  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>Valor de retorno  
 A aparência do controle:  
  
- **0** simples aparência  
  
- **1** aparência 3D  
  
### <a name="remarks"></a>Comentários  
 Chamar essa função para recuperar o valor atual de **DISPID_AMBIENT_APPEARANCE** propriedade do controle.  
  
##  <a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits  
 Retorna o tipo de unidades usadas pelo contêiner.  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Uma cadeia de caracteres que contém o ambiente ScaleUnits do contêiner. Se não há suporte para essa propriedade, a função retornará uma cadeia de caracteres de comprimento zero.  
  
### <a name="remarks"></a>Comentários  
 Propriedade ScaleUnits de ambiente do contêiner pode ser usada para exibir posições ou dimensões, rotuladas com a unidade escolhida, como twips ou centímetros. Observe que o contêiner não é necessário para dar suporte a essa propriedade.  
  
##  <a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles  
 Determina se o contêiner permite o controle para exibir a captura alças para si mesmo quando ativo.  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se os identificadores de captura devem ser exibidos; Caso contrário, 0. Se não há suporte para essa propriedade, essa função retorna zero.  
  
### <a name="remarks"></a>Comentários  
 Observe que o contêiner não é necessário para dar suporte a essa propriedade.  
  
##  <a name="ambientshowhatching"></a>COleControl::AmbientShowHatching  
 Determina se o contêiner permite o controle para exibir a mesmo com um tracejada padrão quando o ativo de interface do usuário.  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o padrão hachurado deve ser mostrado; Caso contrário, 0. Se não há suporte para essa propriedade, essa função retorna zero.  
  
### <a name="remarks"></a>Comentários  
 Observe que o contêiner não é necessário para dar suporte a essa propriedade.  
  
##  <a name="ambienttextalign"></a>COleControl::AmbientTextAlign  
 Determina o alinhamento do texto ambiente preferido pelo contêiner de controle.  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O status da propriedade TextAlign de ambiente do contêiner. Se não há suporte para essa propriedade, essa função retornará 0.  
  
 A seguir está uma lista de valores de retorno válidos:  
  
|Valor retornado|Significado|  
|------------------|-------------|  
|0|Alinhamento geral (números para o texto à direita, à esquerda).|  
|1|Justificar à esquerda|  
|2|Centralizado |  
|3|Justificar à direita|  
  
### <a name="remarks"></a>Comentários  
 Essa propriedade está disponível para todos os controles inseridos e é definida pelo contêiner. Observe que o contêiner não é necessário para dar suporte a essa propriedade.  
  
##  <a name="ambientuidead"></a>COleControl::AmbientUIDead  
 Determina se o contêiner quer o controle para responder a ações de interface do usuário.  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o controle deve responder às ações de interface do usuário; Caso contrário, 0. Se não há suporte para essa propriedade, essa função retornará 0.  
  
### <a name="remarks"></a>Comentários  
 Por exemplo, um contêiner pode configurar isso para **TRUE** no modo de design.  
  
##  <a name="ambientusermode"></a>COleControl::AmbientUserMode  
 Determina se o contêiner estiver em modo de design ou modo de usuário.  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o contêiner estiver em modo de usuário. Caso contrário, 0 (no modo de design). Se não há suporte para essa propriedade, essa função retornará TRUE.  
  
### <a name="remarks"></a>Comentários  
 Por exemplo, um contêiner pode configurar isso para **FALSE** no modo de design.  
  
##  <a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged  
 Indica que o valor da propriedade associada é alterado.  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dispid`  
 A ID de expedição de uma propriedade de limite do controle.  
  
### <a name="remarks"></a>Comentários  
 Isso deve ser chamado sempre que o valor das alterações de propriedade, mesmo nos casos em que a alteração não foi feita por meio da propriedade definir o método. Lembre-se principalmente de propriedades associadas que são mapeadas para variáveis de membro. Sempre que tal um membro variável for alterado, `BoundPropertyChanged` deve ser chamado.  
  
##  <a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit  
 Solicitações de permissão do `IPropertyNotifySink` interface para alterar um valor de propriedade associada fornecido pelo controle.  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dispid`  
 A ID de expedição de uma propriedade de limite do controle.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se a alteração for permitida; Caso contrário, 0. O valor padrão é diferente de zero.  
  
### <a name="remarks"></a>Comentários  
 Se a permissão for negada, o controle não deverá permitir que o valor da alteração de propriedade. Isso pode ser feito por ignorando ou falha da ação que tentou alterar o valor da propriedade.  
  
##  <a name="clienttoparent"></a>COleControl::ClientToParent  
 Converte as coordenadas de `pPoint` em coordenadas pai.  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>Parâmetros  
 `lprcBounds`  
 Ponteiro para os limites do controle OLE dentro do contêiner. A área de todo o controle incluindo bordas e barras de rolagem, mas não a área do cliente.  
  
 `pPoint`  
 Ponteiro para o ponto de área de cliente OLE a ser convertido em coordenadas do pai (contêiner).  
  
### <a name="remarks"></a>Comentários  
 Na entrada `pPoint` é relativo à origem da área cliente do controle OLE (canto superior esquerdo da área cliente do controle). Na saída `pPoint` é relativo à origem do pai (canto superior esquerdo do contêiner).  
  
##  <a name="clipcaretrect"></a>COleControl::ClipCaretRect  
 Ajusta um retângulo de cursor se ele for parcial ou totalmente coberto pelos objetos sobrepostos, opacos.  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpRect`  
 Na entrada, um ponteiro para um [RECT](../../mfc/reference/rect-structure1.md) estrutura que contém a área de cursor a ser ajustado. Na saída, a área de cursor ajustada, ou **nulo** se o retângulo do cursor é completamente coberto.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Um cursor é uma linha, bloquear ou bitmap que normalmente indica onde texto ou elementos gráficos serão inseridos intermitente.  
  
 Um objeto sem janelas com segurança não pode mostrar um cursor sem verificar primeiro se o cursor está parcialmente ou totalmente oculta por objetos sobrepostos. Para que possibilitam, pode usar um objeto `ClipCaretRect` obter o cursor ajustado (redução) para garantir que ele se encaixa na região de recorte.  
  
 Criando um cursor de objetos devem enviar o retângulo de cursor para `ClipCaretRect` e usar o retângulo ajustado para o cursor. Se o cursor é completamente oculta, esse método retornará **FALSE** e o cursor não deve ser mostrado em todos os nesse caso.  
  
##  <a name="colecontrol"></a>COleControl::COleControl  
 Constrói um objeto `COleControl`.  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>Comentários  
 Essa função normalmente não é chamada diretamente. Em vez disso, o controle OLE geralmente é criado por sua fábrica de classe.  
  
##  <a name="controlinfochanged"></a>COleControl::ControlInfoChanged  
 Chame esta função quando o conjunto de mnemônicos suportados pelo controle foi alterado.  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>Comentários  
 Depois de receber esta notificação, o contêiner do controle obtém o novo conjunto de mnemônicos fazendo uma chamada para [IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730). Observe que o contêiner não é necessário para responder à notificação.  
  
##  <a name="displayerror"></a>COleControl::DisplayError  
 Chamado pelo framework depois que o evento de erro de estoque foi tratado (a menos que o manipulador de eventos tiver suprimido a exibição do erro).  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>Parâmetros  
 *SCODE*  
 O valor de código de status a ser relatado. Para obter uma lista completa de possíveis códigos, consulte o artigo [controles ActiveX: tópicos avançados](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 A descrição do erro está sendo relatado.  
  
 *lpszSource*  
 O nome do módulo gera o erro (normalmente, o nome do módulo de controle OLE).  
  
 `lpszHelpFile`  
 O nome do arquivo de Ajuda que contém uma descrição do erro.  
  
 `nHelpID`  
 A ID do contexto de Ajuda do erro está sendo relatado.  
  
### <a name="remarks"></a>Comentários  
 O comportamento padrão exibe uma caixa de mensagem que contém a descrição do erro, contido no `lpszDescription`.  
  
 Substitua essa função para personalizar como os erros são exibidos.  
  
##  <a name="doclick"></a>COleControl::DoClick  
 Simula um mouse clique ação no controle.  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>Comentários  
 O substituível `COleControl::OnClick` função de membro será chamada e um clique evento será acionado, se houver suporte pelo controle de estoque.  
  
 Essa função é suportada pelo `COleControl` classe base como um método de estoque, chamado DoClick. Para obter mais informações, consulte o artigo [controles ActiveX: métodos](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="dopropexchange"></a>COleControl::DoPropExchange  
 Chamado pelo framework quando carregar ou armazenar um controle de uma representação de armazenamento persistente, como um conjunto de fluxo ou propriedade.  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pPX`  
 Um ponteiro para um `CPropExchange` objeto. A estrutura fornece esse objeto para estabelecer o contexto da troca de propriedade, inclusive sua direção.  
  
### <a name="remarks"></a>Comentários  
 Normalmente, essa função faz chamadas para o **px _** família de funções para carregar ou armazenar propriedades específicas definidas pelo usuário de um controle OLE.  
  
 Se o Assistente de controle foi usado para criar o projeto de controle OLE, a versão substituída dessa função serializa as propriedades de estoque com suporte `COleControl` com uma chamada para a função de classe base, `COleControl::DoPropExchange`. Conforme você adiciona propriedades definidas pelo usuário para seu controle OLE, você precisará modificar essa função para serializar as propriedades de novo. Para obter mais informações sobre serialização, consulte o artigo [controles ActiveX: serializando](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint  
 Redesenha a um controle OLE que tenha sido derivado de um controle do Windows.  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pDC`  
 Um ponteiro para o contexto de dispositivo do contêiner de controle.  
  
 `rcBounds`  
 A área na qual o controle será desenhado.  
  
### <a name="remarks"></a>Comentários  
 Chame essa função para manipular adequadamente a pintura de um controle OLE não ativo. Essa função deve ser usada somente se o OLE controla subclasses de um controle do Windows e deve ser chamado no `OnDraw` função do seu controle.  
  
 Para obter mais informações sobre esta função e subclasses de um controle do Windows, consulte o artigo [controles ActiveX: subclasses de um controle de Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).  
  
##  <a name="drawcontent"></a>COleControl::DrawContent  
 Chamado pelo framework quando a aparência do controle precisa ser atualizado.  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pDC`  
 Ponteiro para o contexto de dispositivo.  
  
 `rc`  
 Área retangular a ser desenhada em.  
  
### <a name="remarks"></a>Comentários  
 Esta função chama diretamente o substituível `OnDraw` função.  
  
##  <a name="drawmetafile"></a>COleControl::DrawMetafile  
 Chamado pelo framework quando o contexto de dispositivo de metarquivo está sendo usado.  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pDC`  
 Ponteiro para o contexto de dispositivo de metarquivo.  
  
 `rc`  
 Área retangular a ser desenhada em.  
  
##  <a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame  
 Habilita a característica de quadro simples para um controle OLE.  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>Comentários  
 Essa característica permite um controle dar suporte ao visual confinamento de outros controles, mas não é verdade contenção de OLE. Um exemplo seria com vários controles dentro de uma caixa de grupo. Esses controles não são OLE contido, mas eles estão na mesma caixa de grupo.  
  
##  <a name="exchangeextent"></a>COleControl::ExchangeExtent  
 Serializa ou inicializa o estado da extensão do controle (suas dimensões em **HIMETRIC** unidades).  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pPX`  
 Um ponteiro para um [CPropExchange](../../mfc/reference/cpropexchange-class.md) objeto. A estrutura fornece esse objeto para estabelecer o contexto da troca de propriedade, inclusive sua direção.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se a função foi bem-sucedida. Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Essa função normalmente é chamada pela implementação padrão de `COleControl::DoPropExchange`.  
  
##  <a name="exchangestockprops"></a>COleControl::ExchangeStockProps  
 Serializa ou inicializa o estado do controle propriedades de estoque.  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pPX`  
 Um ponteiro para um [CPropExchange](../../mfc/reference/cpropexchange-class.md) objeto. A estrutura fornece esse objeto para estabelecer o contexto da troca de propriedade, inclusive sua direção.  
  
### <a name="remarks"></a>Comentários  
 Essa função normalmente é chamada pela implementação padrão de `COleControl::DoPropExchange`.  
  
##  <a name="exchangeversion"></a>COleControl::ExchangeVersion  
 Serializa ou inicializa o estado das informações de versão do controle.  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pPX`  
 Um ponteiro para um `CPropExchange` objeto. A estrutura fornece esse objeto para estabelecer o contexto da troca de propriedade, inclusive sua direção.  
  
 `dwVersionDefault`  
 O número de versão atual do controle.  
  
 `bConvert`  
 Indica se os dados persistentes devem ser convertidos para o formato mais recente quando salvo ou mantido no mesmo formato que foi carregado.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero da função foi bem-sucedida. Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Normalmente, isso será a primeira função chamada pela substituição do controle de `COleControl::DoPropExchange`. Ao carregar, essa função lê o número de versão dos dados persistentes e define o atributo da versão de [CPropExchange](../../mfc/reference/cpropexchange-class.md) objeto adequadamente. Ao salvar, essa função grava o número de versão dos dados persistentes.  
  
 Para obter mais informações sobre a persistência e controle de versão, consulte o artigo [controles ActiveX: serializando](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="fireclick"></a>COleControl::FireClick  
 Chamado pelo framework quando o mouse é clicado em um controle ativo.  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>Comentários  
 Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.  
  
 Para acionamento automático de um evento de clique a ocorrer, o mapa de evento do controle deve ter uma ação, clique em eventos definidos.  
  
##  <a name="firedblclick"></a>COleControl::FireDblClick  
 Chamado pelo framework quando o mouse é clicado duas vezes em um controle ativo.  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>Comentários  
 Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.  
  
 Para acionamento automático de um evento DblClick ocorrer, o mapa de evento do controle deve ter um evento DblClick estoque definido.  
  
##  <a name="fireerror"></a>COleControl::FireError  
 Aciona o evento de erro de estoque.  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Parâmetros  
 *SCODE*  
 O valor de código de status a ser relatado. Para obter uma lista completa de possíveis códigos, consulte o artigo [controles ActiveX: tópicos avançados](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 A descrição do erro está sendo relatado.  
  
 `nHelpID`  
 A identificação de Ajuda do erro está sendo relatado.  
  
### <a name="remarks"></a>Comentários  
 Esse evento fornece uma maneira de sinalização em locais apropriados em seu código, que ocorreu um erro dentro de seu controle. Ao contrário de outros eventos de estoque, como clicar ou MouseMove, erro nunca é acionado pela estrutura.  
  
 Para relatar um erro que ocorre durante uma função de get de propriedade, função de conjunto de propriedade ou método de automação, chame [COleControl::ThrowError](#throwerror).  
  
 A implementação do erro de estoque de um controle OLE evento usa uma `SCODE` valor. Se o controle usa esse evento e se destina a ser usado no Visual Basic 4.0, você receberá erros porque o `SCODE` valor não tem suporte no Visual Basic.  
  
 Para corrigir esse problema, altere manualmente o `SCODE` parâmetro do controle. Arquivos ODL para um **longo**. Além disso, qualquer evento personalizado, método ou propriedade que usa um `SCODE` parâmetro também faz com que o mesmo problema.  
  
##  <a name="fireevent"></a>COleControl::FireEvent  
 Dispara um evento definido pelo usuário de seu controle com qualquer número de argumentos opcionais.  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dispid`  
 A ID de expedição do evento a ser acionado.  
  
 `pbParams`  
 Um descritor de tipos de parâmetro do evento.  
  
### <a name="remarks"></a>Comentários  
 Normalmente essa função não deve ser chamada diretamente. Em vez disso, você chamará as funções de acionamento do evento na seção de mapa de evento da declaração de classe do controle.  
  
 O `pbParams` argumento é uma lista separada por espaços de **VTS_**. Um ou mais desses valores, separados por espaços (não vírgulas), especifica a lista de parâmetros da função. Os valores possíveis são:  
  
|Símbolo|Tipo de parâmetro|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE**|**IPictureDisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  Constantes variantes adicionais foram definidas para todos os tipos de variável, com exceção de **VTS_FONT** e **VTS_PICTURE**, que fornecem um ponteiro para a constante de dados variant. Essas constantes são nomeados por meio de **VTS_P** `constantname` convenção. Por exemplo, **VTS_PCOLOR** é um ponteiro para um **VTS_COLOR** constante.  
  
##  <a name="firekeydown"></a>COleControl::FireKeyDown  
 Chamado pelo framework quando uma tecla é pressionada enquanto o controle é a interface do usuário ativo.  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pnChar`  
 Ponteiro para o valor de código de tecla virtual da tecla pressionada. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser  
  
 `nShiftState`  
 Contém uma combinação dos sinalizadores a seguir:  
  
- **SHIFT_MASK** foi pressionada a tecla SHIFT durante a ação.  
  
- **CTRL_MASK** CTRL a tecla foi pressionada durante a ação.  
  
- **ALT_MASK** ALT a tecla foi pressionada durante a ação.  
  
### <a name="remarks"></a>Comentários  
 Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.  
  
 Para acionamento automático de um evento KeyDown ocorra, o mapa de evento do controle deve ter um evento KeyDown estoque definido.  
  
##  <a name="firekeypress"></a>COleControl::FireKeyPress  
 Chamado pelo framework quando uma tecla é pressionada e liberada enquanto o controle personalizado está ativo de interface do usuário dentro do contêiner.  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pnChar`  
 Um ponteiro para o valor do caractere da tecla pressionada.  
  
### <a name="remarks"></a>Comentários  
 Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.  
  
 O destinatário do evento pode modificar `pnChar`, por exemplo, converter todos os caracteres minúsculos em maiusculos. Se você deseja examinar o caractere modificado, substituir `OnKeyPressEvent`.  
  
 Para acionamento automático de um evento KeyPress ocorra, o mapa de evento do controle deve ter um evento KeyPress estoque definido.  
  
##  <a name="firekeyup"></a>COleControl::FireKeyUp  
 Chamado pelo framework quando uma tecla é liberada enquanto o controle personalizado está ativa de interface do usuário dentro do contêiner.  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pnChar`  
 Ponteiro para o valor de código de tecla virtual da chave de lançamento. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser  
  
 `nShiftState`  
 Contém uma combinação dos sinalizadores a seguir:  
  
- **SHIFT_MASK** foi pressionada a tecla SHIFT durante a ação.  
  
- **CTRL_MASK** CTRL a tecla foi pressionada durante a ação.  
  
- **ALT_MASK** ALT a tecla foi pressionada durante a ação.  
  
### <a name="remarks"></a>Comentários  
 Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.  
  
 Para acionamento automático de um evento KeyUp ocorra, o mapa de evento do controle deve ter um evento KeyUp estoque definido.  
  
##  <a name="firemousedown"></a>COleControl::FireMouseDown  
 Chamado pelo framework quando um botão do mouse é pressionado sobre um controle personalizado ativo.  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parâmetros  
 `nButton`  
 O valor numérico do botão do mouse pressionado. Ele pode conter um dos seguintes valores:  
  
- **LEFT_BUTTON** o botão esquerdo do mouse foi pressionado.  
  
- **MIDDLE_BUTTON** o botão do meio foi pressionado.  
  
- **RIGHT_BUTTON** o botão direito do mouse foi pressionado.  
  
 `nShiftState`  
 Contém uma combinação dos sinalizadores a seguir:  
  
- **SHIFT_MASK** foi pressionada a tecla SHIFT durante a ação.  
  
- **CTRL_MASK** CTRL a tecla foi pressionada durante a ação.  
  
- **ALT_MASK** ALT a tecla foi pressionada durante a ação.  
  
 *x*  
 A coordenada x do cursor quando um botão do mouse foi pressionado. A coordenada é relativo ao canto superior esquerdo da janela do controle.  
  
 *y*  
 A coordenada y do cursor quando um botão do mouse foi pressionado. A coordenada é relativo ao canto superior esquerdo da janela do controle.  
  
### <a name="remarks"></a>Comentários  
 Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.  
  
 Para acionamento automático de um evento MouseDown ocorra, o mapa de evento do controle deve ter um evento MouseDown estoque definido.  
  
##  <a name="firemousemove"></a>COleControl::FireMouseMove  
 Chamado pelo framework quando o cursor é movido sobre um controle personalizado ativo.  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parâmetros  
 `nButton`  
 O valor numérico dos botões do mouse é pressionado. Contém uma combinação dos seguintes valores:  
  
- **LEFT_BUTTON** o botão esquerdo do mouse foi pressionado durante a ação.  
  
- **MIDDLE_BUTTON** o botão do meio foi pressionado durante a ação.  
  
- **RIGHT_BUTTON** o botão direito do mouse foi pressionado durante a ação.  
  
 `nShiftState`  
 Contém uma combinação dos sinalizadores a seguir:  
  
- **SHIFT_MASK** foi pressionada a tecla SHIFT durante a ação.  
  
- **CTRL_MASK** CTRL a tecla foi pressionada durante a ação.  
  
- **ALT_MASK** ALT a tecla foi pressionada durante a ação.  
  
 *x*  
 A coordenada x do cursor. A coordenada é relativo ao canto superior esquerdo da janela do controle.  
  
 *y*  
 A coordenada y do cursor. A coordenada é relativo ao canto superior esquerdo da janela do controle.  
  
### <a name="remarks"></a>Comentários  
 Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.  
  
 Para acionamento automático de um evento MouseMove ocorra, o mapa de evento do controle deve ter um evento MouseMove estoque definido.  
  
##  <a name="firemouseup"></a>COleControl::FireMouseUp  
 Chamado pelo framework quando um botão do mouse é liberado em um controle personalizado ativo.  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parâmetros  
 `nButton`  
 O valor numérico do botão do mouse liberado. Ele pode ter um dos seguintes valores:  
  
- **LEFT_BUTTON** o botão esquerdo foi liberado.  
  
- **MIDDLE_BUTTON** o botão do meio foi liberado.  
  
- **RIGHT_BUTTON** o botão direito do mouse foi liberado.  
  
 `nShiftState`  
 Contém uma combinação dos sinalizadores a seguir:  
  
- **SHIFT_MASK** foi pressionada a tecla SHIFT durante a ação.  
  
- **CTRL_MASK** CTRL a tecla foi pressionada durante a ação.  
  
- **ALT_MASK** ALT a tecla foi pressionada durante a ação.  
  
 *x*  
 A coordenada x do cursor quando um botão do mouse foi lançado. A coordenada é relativo ao canto superior esquerdo da janela do controle.  
  
 *y*  
 A coordenada y de um cursor quando um botão do mouse foi lançado. A coordenada é relativo ao canto superior esquerdo da janela do controle.  
  
### <a name="remarks"></a>Comentários  
 Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.  
  
 Para acionamento automático de um evento MouseUp ocorra, o mapa de evento do controle deve ter um evento MouseUp estoque definido.  
  
##  <a name="firereadystatechange"></a>COleControl::FireReadyStateChange  
 Dispara um evento com o valor atual de estado pronto do controle.  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>Comentários  
 O estado pronto pode ser um dos seguintes valores:  
  
 **READYSTATE_UNINITIALIZED**  
 Estado de inicialização padrão  
  
 **READYSTATE_LOADING**  
 Controle atualmente está carregando suas propriedades  
  
 **READYSTATE_LOADED**  
 Controle foi inicializado  
  
 **READYSTATE_INTERACTIVE**  
 Controle tem dados suficientes para ser interativo mas assíncronos não todos os dados ainda estão carregados  
  
 `READYSTATE_COMPLETE`  
 Controle tem todos os seus dados  
  
 Use [GetReadyState](#getreadystate) para determinar a prontidão atual do controle.  
  
 [InternalSetReadyState](#internalsetreadystate) altera o estado pronto para o valor fornecido e, em seguida, chama `FireReadyStateChange`.  
  
##  <a name="getactivationpolicy"></a>COleControl::GetActivationPolicy  
 Altera o comportamento de ativação padrão de um controle que oferece suporte a `IPointerInactive` interface.  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Uma combinação de sinalizadores do **POINTERINACTIVE** enumeração. Os sinalizadores possíveis são:  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 O objeto deve ser ativado quando o mouse entra ele durante uma operação de movimentação do mouse no local.  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 O objeto deve ser desativado quando o mouse sai do objeto durante uma operação de movimentação do mouse.  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 O objeto deve ser ativado quando o mouse é arrastado sobre ele durante um arraste no local e solte a operação.  
  
### <a name="remarks"></a>Comentários  
 Quando o `IPointerInactive` interface está habilitada, o contêiner delegará `WM_SETCURSOR` e `WM_MOUSEMOVE` mensagens a ele. `COleControl`da implementação dessa interface enviará essas mensagens pelo mapa de mensagem do controle, depois de ajustar o mouse coordena adequadamente.  
  
 Sempre que o contêiner recebe um `WM_SETCURSOR` ou `WM_MOUSEMOVE` mensagem com o ponteiro do mouse sobre um objeto inativo que oferece suporte `IPointerInactive`, é necessário chamar `GetActivationPolicy` na interface e sinalizadores de retorno do **POINTERINACTIVE** enumeração.  
  
 Você pode processar essas mensagens como mensagens de janela comum, adicionando as entradas correspondentes no mapa de mensagem. Em seus manipuladores, evite usar o `m_hWnd` variável de membro (ou qualquer função de membro que utiliza) sem primeiro verificar se o valor é não - **nulo**.  
  
 Qualquer objeto destinado a mais de definir o cursor do mouse e/ou disparar um evento de movimentação do mouse, tais como fornecer comentários visuais especiais, devem retornar o **POINTERINACTIVE_ACTIVATEONENTRY** sinalizador e desenhar os comentários ao ativo. Se o objeto retorna esse sinalizador, o contêiner deve ativá-lo em vigor imediatamente e, em seguida, encaminhá-lo a mesma mensagem que disparou a chamada para `GetActivationPolicy`.  
  
 Se o **POINTERINACTIVE_ACTIVATEONENTRY** e **POINTERINACTIVE_DEACTIVATEONLEAVE** sinalizadores são retornados, em seguida, o objeto só será ativado quando o mouse estiver sobre o objeto. Se apenas o **POINTERINACTIVE_ACTIVATEONENTRY** sinalizador é retornado, em seguida, o objeto só será ativado quando quando o mouse entra pela primeira vez o objeto.  
  
 Também convém um controle inativo para ser o destino de arrastar um OLE e solte a operação. Isso requer ativando o controle no momento em que o usuário arrasta um objeto, para que a janela do controle pode ser registrada como um destino de soltar. Para fazer com que ocorrem durante um arrastar a ativação, retornar o **POINTERINACTIVE_ACTIVATEONDRAG** sinalizador:  
  
 [!code-cpp[NVC_MFCAxCtl n º 1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 As informações comunicadas por `GetActivationPolicy` não deve ser em cache por um contêiner. Em vez disso, esse método deve ser chamado sempre que o mouse entra em um objeto inativo.  
  
 Se um objeto inativo não solicitar para ser ativado quando o mouse entra-lo no local, seu contêiner deve expedir subsequentes `WM_SETCURSOR` mensagens para esse objeto chamando [OnInactiveSetCursor](#oninactivesetcursor) enquanto o ponteiro do mouse permanece sobre o objeto.  
  
 Habilitando o `IPointerInactive` interface normalmente significa que você deseja que o controle seja capaz de processar mensagens do mouse em todos os momentos. Para obter esse comportamento em um contêiner que não oferece suporte a `IPointerInactive` interface, você precisará ter o controle sempre ativado quando visível, que significa que o controle deve ter o **OLEMISC_ACTIVATEWHENVISIBLE** sinalizador entre seus diversos sinalizadores. No entanto, para evitar esse sinalizador de entrar em vigor em um contêiner que oferece suporte `IPointerInactive`, você também pode especificar o **OLEMISC_IGNOREACTIVATEWHENVISIBLE** sinalizador:  
  
 [!code-cpp[NVC_MFCAxCtl #10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>COleControl::GetAmbientProperty  
 Obtém o valor de uma propriedade de ambiente do contêiner.  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>Parâmetros  
 *dwDispid*  
 A ID de expedição da propriedade ambiente desejada.  
  
 `vtProp`  
 Marca um tipo variante que especifica o tipo do valor a ser retornado em `pvProp`.  
  
 `pvProp`  
 Um ponteiro para o endereço da variável que receberá o valor da propriedade ou valor de retorno. O tipo real deste ponteiro deve corresponder ao tipo especificado pelo `vtProp`.  
  
|vtProp|Tipo de pvProp|  
|------------|--------------------|  
|`VT_BOOL`|**BOOL\***|  
|`VT_BSTR`|**CString\***|  
|`VT_I2`|**curto\***|  
|`VT_I4`|**Longas\***|  
|`VT_R4`|**float\***|  
|`VT_R8`|**duplo\***|  
|`VT_CY`|**CY\***|  
|**VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se há suporte para a propriedade de ambiente; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Se você usar `GetAmbientProperty` para recuperar propriedades de ambiente DisplayName e ScaleUnits, defina `vtProp` para `VT_BSTR` e `pvProp` para **CString\***. Se você estiver recuperando a propriedade de fonte de ambiente, defina `vtProp` para **VT_FONT** e `pvProp` para **LPFONTDISP\***.  
  
 Observe que funções já foram fornecidas para propriedades de ambiente comuns, como [AmbientBackColor](#ambientbackcolor) e [AmbientFont](#ambientfont).  
  
##  <a name="getappearance"></a>COleControl::GetAppearance  
 Implementa a função Get de propriedade estoque de aparência do controle.  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O valor de retorno Especifica a configuração de aparência atual como um **curto** ( `VT_I2`) de valor, se for bem-sucedido. Esse valor é zero se a aparência do controle é simples e 1 se a aparência do controle é 3D.  
  
##  <a name="getbackcolor"></a>COleControl::GetBackColor  
 Implementa a função Get da propriedade BackColor de estoque do controle.  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O valor de retorno Especifica a cor de plano de fundo atual como um **OLE_COLOR** valor, se for bem-sucedido. Esse valor pode ser convertido para um **COLORREF** valor com uma chamada para `TranslateColor`.  
  
##  <a name="getborderstyle"></a>COleControl::GetBorderStyle  
 Implementa a função Get da propriedade BorderStyle de estoque do controle.  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>Valor de retorno  
 1 se o controle terá uma borda normal; 0 se o controle não tem nenhuma borda.  
  
##  <a name="getcapture"></a>COleControl::GetCapture  
 Determina se o `COleControl` objeto tem a captura do mouse.  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Retorna se o controle está ativada e sem janelas, **isso** se o controle tiver atualmente a captura do mouse (conforme determinado pelo contêiner de controle), ou **nulo** se não tiver a captura.  
  
 Caso contrário, retorna o `CWnd` objeto que tem a captura do mouse (mesmo que `CWnd::GetCapture`).  
  
### <a name="remarks"></a>Comentários  
 Um controle sem janelas ativado recebe o mouse capturar quando [SetCapture](#setcapture) é chamado.  
  
##  <a name="getclassid"></a>COleControl::GetClassID  
 Chamado pelo framework para recuperar a ID de classe OLE do controle.  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>Parâmetros  
 *pclsid*  
 Ponteiro para o local da ID da classe.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se a chamada não foi bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Geralmente é implementado pelo [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).  
  
##  <a name="getclientoffset"></a>COleControl::GetClientOffset  
 Recupera a diferença entre o canto superior esquerdo da área retangular do controle e o canto superior esquerdo de sua área cliente.  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>Parâmetros  
 *pdxOffset*  
 Ponteiro para o deslocamento horizontal da área do cliente do controle OLE.  
  
 *pdyOffset*  
 Ponteiro para o deslocamento vertical da área do cliente do controle OLE.  
  
### <a name="remarks"></a>Comentários  
 O controle OLE tem uma área retangular dentro do respectivo contêiner. O cliente do controle é a área de controle excluindo bordas e barras de rolagem. O deslocamento é recuperada por `GetClientOffset` é a diferença entre o canto superior esquerdo da área retangular do controle e o canto superior esquerdo de sua área cliente. Se o controle tiver elementos não clientes diferente do padrão bordas e barras de rolagem, substitua essa função de membro para especificar o deslocamento.  
  
##  <a name="getclientrect"></a>COleControl::GetClientRect  
 Recupera o tamanho da área do cliente do controle.  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpRect`  
 Ponteiro para um `RECT` estrutura que contém as dimensões da área do cliente do controle sem janelas; isto é, o tamanho do controle menos bordas de janela, quadros, barras de rolagem e assim por diante. O `lpRect` parâmetro indica o tamanho do retângulo de cliente de controle, não sua posição.  
  
##  <a name="getclientsite"></a>COleControl::GetClientSite  
 Consultas de um objeto para o ponteiro para seu site do cliente atual dentro do respectivo contêiner.  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Um ponteiro para o site de cliente atual do controle em seu contêiner.  
  
### <a name="remarks"></a>Comentários  
 O ponteiro retornado aponta para uma instância de `IOleClientSite`. O `IOleClientSite` interface implementada por contêineres, é o modo de exibição do objeto de seu contexto: onde ele está ancorado no documento, em que ele obtém seu armazenamento, a interface do usuário e outros recursos.  
  
##  <a name="getcontrolflags"></a>COleControl::GetControlFlags  
 Recupera as configurações de sinalizador de controle.  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Uma combinação ORed dos sinalizadores na enumeração ControlFlags:  
  
```  
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };  
```  
  
### <a name="remarks"></a>Comentários  
 Por padrão, `GetControlFlags` retorna `fastBeginPaint | clipPaintDC`.  
  
 `fastBeginPaint`  
 Se definido, função usa uma início de pintura adaptados para controles OLE em vez do [BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) API (definido por padrão).  
  
 `clipPaintDC`  
 Se não for definido, desabilita a chamada para `IntersectClipRect` feitas por `COleControl` e obtém uma vantagem de velocidade pequeno. Se você estiver usando a ativação sem janelas, o sinalizador não terá efeito.  
  
 `pointerInactive`  
 Se definido, fornece a interação do mouse enquanto o controle está inativo, permitindo `COleControl`da implementação do `IPointerInactive` interface, que é desabilitada por padrão.  
  
 `noFlickerActivate`  
 Se definido, elimina as operações de desenho extra e a oscilação visual. Use quando o controlo se desenha identicamente nos Estados inativos e ativos. Se você estiver usando a ativação sem janelas, o sinalizador não terá efeito.  
  
 `windowlessActivate`  
 Se configurado, indica que o controle usará a ativação sem janelas.  
  
 `canOptimizeDraw`  
 Se configurado, indica que o controle executará desenho otimizado, se o contêiner for compatível.  
  
 Para obter mais informações sobre `GetControlFlags` e outras otimizações de controles OLE, consulte [controles ActiveX: otimização](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="getcontrolsize"></a>COleControl::GetControlSize  
 Recupera o tamanho da janela de controle OLE.  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>Parâmetros  
 *PCX*  
 Especifica a largura do controle em pixels.  
  
 *pcy*  
 Especifica a altura do controle em pixels.  
  
### <a name="remarks"></a>Comentários  
 Observe que todas as coordenadas do windows de controle em relação ao canto superior esquerdo do controle.  
  
##  <a name="getdc"></a>COleControl::GetDC  
 Fornece um objeto sem janelas get uma tela (ou compatíveis) contexto de dispositivo de seu contêiner.  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>Parâmetros  
 *lprcRect*  
 Um ponteiro para o retângulo de controle sem janelas deseja redesenhar, nas coordenadas do cliente do controle. **NULO** significa a extensão do objeto completo.  
  
 `dwFlags`  
 Atributos de desenho do contexto do dispositivo. As opções são:  
  
- **OLEDC_NODRAW** indica que o objeto não usa o contexto de dispositivo para executar qualquer desenho mas simplesmente para obter informações sobre o dispositivo de vídeo. O contêiner deve simplesmente passar DC da janela sem processamento adicional.  
  
- **OLEDC_PAINTBKGND** solicita que o contêiner pintar o segundo plano antes de retornar o controlador de domínio. Um objeto deve usar esse sinalizador, se ele está solicitando um controlador de domínio para redesenhar uma área com plano de fundo transparente.  
  
- **OLEDC_OFFSCREEN** informa o contêiner que o objeto deseja renderizar em um bitmap fora da tela que deve ser copiado para a tela. Um objeto deve usar esse sinalizador quando ele está prestes a realizar a operação de desenho gera muita cintilação. O contêiner está livre para honram esta solicitação ou não. No entanto, se este sinalizador não for definido, o contêiner deve devolver na tela CC. Isso permite que os objetos executar operações diretamente na tela, como mostra uma seleção (por meio de um **XOR** operação).  
  
### <a name="return-value"></a>Valor de retorno  
 Ponteiro para o contexto de dispositivo de exibição para o contêiner `CWnd` área cliente se bem-sucedido; caso contrário, o valor de retorno é **nulo**. O contexto de dispositivo de exibição pode ser usado em funções GDI subsequentes para desenhar a área cliente da janela do contêiner.  
  
### <a name="remarks"></a>Comentários  
 O [ReleaseDC](#releasedc) função de membro deve ser chamada para liberar o contexto depois de pintura. Ao chamar `GetDC`, objetos passam o retângulo que desejam desenhar em seus próprios coordenadas do cliente. `GetDC`Converte coordenadas da área cliente do contêiner. O objeto não deve solicitar um retângulo de desenho desejado maior do que seu próprio retângulo da área de cliente, o tamanho que pode ser recuperado com [GetClientRect](#getclientrect). Isso impede que objetos inadvertidamente desenho em que eles não deveriam.  
  
##  <a name="getenabled"></a>COleControl::GetEnabled  
 Implementa a função Get da propriedade Enabled de estoque do controle.  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o controle estiver habilitado; Caso contrário, 0.  
  
##  <a name="getextendedcontrol"></a>COleControl::GetExtendedControl  
 Obtém um ponteiro para um objeto mantido pelo contêiner que representa o controle com um conjunto de propriedades estendidos.  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Um ponteiro para o contêiner estendidos do objeto de controle. Se não houver nenhum objeto disponível, o valor será **nulo**.  
  
 Esse objeto pode ser manipulado por meio de seu `IDispatch` interface. Você também pode usar `QueryInterface` para obter outras interfaces disponíveis fornecidos pelo objeto. No entanto, o objeto não é necessário para dar suporte a um conjunto específico de interfaces. Observe que depender de recursos específicos do objeto de controle estendido do contêiner limita a portabilidade de seu controle outros contêineres arbitrários.  
  
### <a name="remarks"></a>Comentários  
 A função que chama esta função é responsável pela liberação do ponteiro quando terminar com o objeto. Observe que o contêiner não é necessário para dar suporte a esse objeto.  
  
##  <a name="getfocus"></a>COleControl::GetFocus  
 Determina se o `COleControl` objeto tem o foco.  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Retorna se o controle está ativada e sem janelas, **isso** se o controle tem o foco do teclado (conforme determinado pelo contêiner de controle), ou **nulo** se ele não tem o foco.  
  
 Caso contrário, retorna o `CWnd` objeto que tem o foco (mesmo que `CWnd::GetFocus`).  
  
### <a name="remarks"></a>Comentários  
 Um controle sem janelas ativado recebe o foco quando [SetFocus](#setfocus) é chamado.  
  
##  <a name="getfont"></a>COleControl::GetFont  
 Implementa a função Get da propriedade Font estoque.  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Um ponteiro para a interface de expedição de fonte de estoque do controle propriedade Font.  
  
### <a name="remarks"></a>Comentários  
 Observe que o chamador deve liberar o objeto quando terminado. Dentro da implementação do controle, use `InternalGetFont` para acessar o objeto de fonte das ações do controle. Para obter mais informações sobre o uso de fontes em seu controle, consulte o artigo [controles ActiveX: usando fontes em um controle ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).  
  
##  <a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics  
 Mede as métricas de texto para qualquer `CFontHolder` objeto de propriedade do controle.  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lptm`  
 Ponteiro para um [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) estrutura.  
  
 `fontHolder`  
 Referência a um [CFontHolder](../../mfc/reference/cfontholder-class.md) objeto.  
  
### <a name="remarks"></a>Comentários  
 A fonte pode ser selecionada com a [COleControl::SelectFontObject](#selectfontobject) função. `GetFontTextMetrics`inicializar o `TEXTMETRIC` estrutura apontada por `lptm` com informações válidas de métricas sobre `fontHolder`da fonte, se for bem-sucedido, ou preencher a estrutura com zeros, se não for bem-sucedido. Você deve usar essa função em vez de [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) quando pintando seu controle porque os controles, como qualquer inserido o objeto OLE, podem ser necessário para renderizar a próprios em metarquivo.  
  
 O `TEXTMETRIC` estrutura para a fonte padrão é atualizada quando o [SelectFontObject](#selectfontobject) função é chamada. Você deve chamar `GetFontTextMetrics` somente depois de selecionar a propriedade de estoque fonte para garantir que as informações fornecidas é válido.  
  
##  <a name="getforecolor"></a>COleControl::GetForeColor  
 Implementa a função Get da propriedade ForeColor estoque.  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O valor de retorno Especifica a cor de primeiro plano atual como um **OLE_COLOR** valor, se for bem-sucedido. Esse valor pode ser convertido para um [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) valor com uma chamada para `TranslateColor`.  
  
##  <a name="gethwnd"></a>COleControl::GetHwnd  
 Implementa a função Get da propriedade hWnd de estoque.  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Identificador de janela do controle OLE, se houver; Caso contrário, **nulo**.  
  
##  <a name="getmessagestring"></a>COleControl::GetMessageString  
 Chamado pelo framework para obter uma pequena cadeia de caracteres que descreve a finalidade do item de menu identificado por `nID`.  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>Parâmetros  
 `nID`  
 Uma ID de item de menu.  
  
 `rMessage`  
 Uma referência a um [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto por meio do qual uma cadeia de caracteres será retornada.  
  
### <a name="remarks"></a>Comentários  
 Isso pode ser usado para obter uma mensagem para exibição em uma barra de status enquanto o item de menu é realçado. A implementação padrão tenta carregar um recurso de cadeia de caracteres identificado pelo `nID`.  
  
##  <a name="getnotsupported"></a>COleControl::GetNotSupported  
 Impede o acesso ao valor de propriedade do controle do usuário.  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>Comentários  
 Chame essa função em vez da função Get de qualquer propriedade onde não há suporte para recuperação da propriedade de usuário do controle. Um exemplo seria uma propriedade que é somente gravação.  
  
##  <a name="getreadystate"></a>COleControl::GetReadyState  
 Retorna o estado de preparação do controle.  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O estado de preparação do controle, um dos seguintes valores:  
  
 **READYSTATE_UNINITIALIZED**  
 Estado de inicialização padrão  
  
 **READYSTATE_LOADING**  
 Controle atualmente está carregando suas propriedades  
  
 **READYSTATE_LOADED**  
 Controle foi inicializado  
  
 **READYSTATE_INTERACTIVE**  
 Controle tem dados suficientes para ser interativo mas assíncronos não todos os dados ainda estão carregados  
  
 `READYSTATE_COMPLETE`  
 Controle tem todos os seus dados  
  
### <a name="remarks"></a>Comentários  
 A maioria dos controles simples nunca precisa diferenciar **LOADED** e `INTERACTIVE`. No entanto, os controles que oferecem suporte a propriedades de caminho de dados podem não estar prontos para ser interativo até receber pelo menos alguns dados de forma assíncrona. Um controle deve tentar se torna interativa assim que possível.  
  
##  <a name="getrectincontainer"></a>COleControl::GetRectInContainer  
 Obtém as coordenadas do retângulo de controle em relação ao contêiner, expressado em unidades de dispositivo.  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpRect`  
 Um ponteiro para a estrutura de retângulo no qual serão copiadas coordenadas do controle.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o controle está ativo no local; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 O retângulo só será válido se o controle está ativo no local.  
  
##  <a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics  
 Mede a métrica de texto para a propriedade do controle estoque fonte, que pode ser selecionada com a [SelectStockFont](#selectstockfont) função.  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lptm`  
 Um ponteiro para um [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) estrutura.  
  
### <a name="remarks"></a>Comentários  
 O `GetStockTextMetrics` função inicializará o `TEXTMETRIC` estrutura apontada por `lptm` com informações de métricas válida se for bem-sucedido, ou preenchimento a estrutura com zeros, se não for bem-sucedido. Use esta função em vez de [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) quando pintando seu controle porque os controles, como qualquer inserido o objeto OLE, podem ser necessário para renderizar a próprios em metarquivo.  
  
 O `TEXTMETRIC` estrutura para a fonte padrão é atualizada quando o `SelectStockFont` função é chamada. Você deve chamar essa função somente depois de selecionar a fonte de estoque para garantir que as informações fornecidas é válido.  
  
##  <a name="gettext"></a>COleControl::GetText  
 Implementa a função Get da propriedade Text ou Caption estoque.  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O valor atual da cadeia de caracteres de texto de controle ou uma cadeia de caracteres de comprimento zero não se houver nenhuma cadeia de caracteres.  
  
> [!NOTE]
>  Para obter mais informações sobre o `BSTR` tipo de dados, consulte [tipos de dados](../../mfc/reference/data-types-mfc.md) na seção de Macros e globais.  
  
### <a name="remarks"></a>Comentários  
 Observe que o chamador dessa função deve chamar `SysFreeString` a cadeia de caracteres retornada para gratuitamente o recurso. Dentro da implementação do controle, use `InternalGetText` para acessar a propriedade Text ou Caption estoque do controle.  
  
##  <a name="getwindowlessdroptarget"></a>COleControl::GetWindowlessDropTarget  
 Substituir `GetWindowlessDropTarget` quando desejar que um controle sem janelas para ser o destino de um OLE arraste e solte a operação.  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Ponteiro para o objeto `IDropTarget` interface. Desde que ele não tem uma janela, um objeto sem janelas não é possível registrar um `IDropTarget` interface. No entanto, para participar de arrastar e soltar, um objeto sem janelas pode ainda implementa a interface e retorná-la no `GetWindowlessDropTarget`.  
  
### <a name="remarks"></a>Comentários  
 Normalmente, isso requer que a janela do controle ser registrado como um destino de soltar. Mas, desde que o controle não tem nenhuma janela de seu próprio, o contêiner usará sua própria janela como um destino de soltar. O controle simplesmente precisa fornecer uma implementação de `IDropTarget` interface para o qual o contêiner pode delegar chamadas no momento apropriado. Por exemplo:  
  
 [!code-cpp[NVC_MFCAxCtl n º 2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>COleControl::InitializeIIDs  
 Informa a classe base das IIDs o controle usará.  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>Parâmetros  
 *piidPrimary*  
 Ponteiro para a identificação da interface de Despache primária do controle.  
  
 *piidEvents*  
 Ponteiro para a ID de interface da interface de eventos do controle.  
  
### <a name="remarks"></a>Comentários  
 Chame essa função no construtor do controle para informar a classe base da interface IDs usando o seu controle.  
  
##  <a name="internalgetfont"></a>COleControl::InternalGetFont  
 Acessa a propriedade de fonte de estoque de seu controle  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Uma referência a um [CFontHolder](../../mfc/reference/cfontholder-class.md) objeto que contém o objeto de fonte de estoque.  
  
##  <a name="internalgettext"></a>COleControl::InternalGetText  
 Acessa a propriedade Text ou Caption estoque de seu controle.  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Uma referência para a cadeia de caracteres de texto do controle.  
  
##  <a name="internalsetreadystate"></a>COleControl::InternalSetReadyState  
 Define o estado de preparação do controle.  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>Parâmetros  
 *lNewReadyState*  
 O estado de preparação definido para o controle, um dos seguintes valores:  
  
 **READYSTATE_UNINITIALIZED**  
 Estado de inicialização padrão  
  
 **READYSTATE_LOADING**  
 Controle atualmente está carregando suas propriedades  
  
 **READYSTATE_LOADED**  
 Controle foi inicializado  
  
 **READYSTATE_INTERACTIVE**  
 Controle tem dados suficientes para ser interativo mas assíncronos não todos os dados ainda estão carregados  
  
 `READYSTATE_COMPLETE`  
 Controle tem todos os seus dados  
  
### <a name="remarks"></a>Comentários  
 A maioria dos controles simples nunca precisa diferenciar **LOADED** e `INTERACTIVE`. No entanto, os controles que oferecem suporte a propriedades de caminho de dados podem não estar prontos para ser interativo até receber pelo menos alguns dados de forma assíncrona. Um controle deve tentar se torna interativa assim que possível.  
  
##  <a name="invalidatecontrol"></a>COleControl::InvalidateControl  
 Força o controle a ser redesenhado.  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpRect`  
 Um ponteiro para a região do controle a ser invalidado.  
  
 `bErase`  
 Especifica se o plano de fundo dentro da região de atualização deve ser apagada quando a região de atualização é processada.  
  
### <a name="remarks"></a>Comentários  
 Se `lpRect` tem um **nulo** valor, todo o controle será redesenhado. Se `lpRect` não é **nulo**, isso indica que a parte do retângulo de controle a ser invalidado. Em casos onde o controle não tem nenhuma janela ou não está ativo no momento, o retângulo é ignorado, e é feita uma chamada para o site do cliente [IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337) função de membro. Use esta função em vez de `CWnd::InvalidateRect` ou `InvalidateRect`.  
  
##  <a name="invalidatergn"></a>COleControl::InvalidateRgn  
 Invalida a área de cliente da janela do contêiner em determinada região.  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pRgn`  
 Um ponteiro para um [CRgn](../../mfc/reference/crgn-class.md) objeto que identifica a região de exibição do objeto OLE para invalidar, nas coordenadas do cliente da janela. Se esse parâmetro for **nulo**, a extensão é o objeto inteiro.  
  
 `bErase`  
 Especifica se o plano de fundo dentro da região invalidada deve ser apagados. Se **TRUE**, o plano de fundo é apagado. Se **FALSE**, o plano de fundo permanece inalterado.  
  
### <a name="remarks"></a>Comentários  
 Isso pode ser usado para redesenhar a controles sem janelas dentro do contêiner. A região invalidada, juntamente com todas as outras áreas na região de atualização, é marcada para pintura quando o próximo [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) mensagem é enviada.  
  
 Se `bErase` é **TRUE** para qualquer parte da região de atualização, o plano de fundo em toda a região, não apenas na parte fornecido, será apagado.  
  
##  <a name="isconvertingvbx"></a>COleControl::IsConvertingVBX  
 Permite o carregamento especializado de um controle OLE.  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o controle está sendo convertido; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Quando a conversão de um formulário que usa VBX controles para um que usa os controles OLE, código de carregamento especiais para os controles OLE pode ser necessário. Por exemplo, se você estiver carregando uma instância do seu controle OLE, você pode ter uma chamada para [PX_Font](persistence-of-ole-controls.md#px_font) no seu `DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl n º 3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 No entanto, os controles VBX não tinha um objeto de fonte; cada propriedade de fonte foi salvo individualmente. Nesse caso, você usaria `IsConvertingVBX` para distinguir entre esses dois casos:  
  
 [!code-cpp[NVC_MFCAxCtl n º 4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 Outro caso seria se o controle VBX salvo proprietários dados binários (em seu **VBM_SAVEPROPERTY** manipulador de mensagens), e seu controle OLE salva os dados binários em um formato diferente. Se você desejar que o controle OLE a ser compatibilidade com o controle VBX, você pode ler dois formatos antigos e novos usando o `IsConvertingVBX` função pela distinguir se o controle VBX ou controle OLE estava sendo carregado.  
  
 No seu controle `DoPropExchange` função, você pode verificar essa condição e se for true, execute o código de carga específico para essa conversão (como nos exemplos anteriores). Se o controle não está sendo convertido, você pode executar o código de carga normal. Esse recurso só é aplicável aos controles que está sendo convertidos de contrapartes VBX.  
  
##  <a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed  
 Permite a invocação de método de automação.  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o controle tiver sido inicializado; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 A implementação da estrutura de **IDispatch:: Invoke** chamadas **IsInvokeAllowed** para determinar se uma determinada função (identificada pelo `dispid`) pode ser chamado. O comportamento padrão para um controle OLE é permitir que os métodos de automação a ser invocado apenas se o controle foi inicializado; No entanto, **IsInvokeAllowed** é uma função virtual e pode ser substituído se necessário (por exemplo, quando o controle está sendo usado como um servidor de automação). Para obter mais informações, consulte o artigo da Base de dados de Conhecimento Q166472, "como: usar um controle OLE como um servidor de automação." Artigos da Base de dados de Conhecimento estão disponíveis na documentação do MSDN Library Visual Studio ou em [http://support.microsoft.com](http://support.microsoft.com/).  
  
##  <a name="ismodified"></a>COleControl::IsModified  
 Determina se o estado do controle foi modificado.  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o estado do controle tiver sido modificado desde que ele foi salvo pela última vez; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 O estado de um controle é modificado quando uma propriedade de valor é alterado.  
  
##  <a name="isoptimizeddraw"></a>COleControl::IsOptimizedDraw  
 Determina se o contêiner suporta desenho otimizado para a operação atual de desenho.  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>Valor de retorno  
 **TRUE** se o contêiner suporta otimizado para a operação atual de desenho de desenho; caso contrário **FALSE**.  
  
### <a name="remarks"></a>Comentários  
 Se há suporte para desenho otimizado, o controle necessário não selecionar objetos antigos (canetas, pincéis, fontes, etc.) no contexto de dispositivo ao desenho for concluído.  
  
##  <a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl  
 Chamado pelo framework para determinar se o controle subdivide um Windows controla.  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o controle é uma subclasse; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Você deve substituir esta função e retornar **TRUE** se o OLE controle subclasses de um controle do Windows.  
  
##  <a name="load"></a>COleControl::Load  
 Redefine todos os dados anteriores carregados de forma assíncrona e inicia uma nova carga de propriedade assíncrona do controle.  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>Parâmetros  
 *strNewPath*  
 Um ponteiro para uma cadeia de caracteres que contém o caminho que faz referência a localização absoluta da propriedade de controle assíncrono.  
  
 *prop*  
 Um [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) objeto que implementa uma propriedade de controle assíncrono.  
  
##  <a name="lockinplaceactive"></a>COleControl::LockInPlaceActive  
 Impede que o contêiner desativar seu controle.  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>Parâmetros  
 `bLock`  
 **TRUE** se o estado ativo no local do controle deve ser bloqueada; **FALSE** se ele deve ser desbloqueada.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o bloqueio foi bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Observe que cada bloqueio do controle deve estar combinado com um desbloqueio do controle quando terminar. Você só deve bloquear seu controle por curtos períodos, como ao disparar um evento.  
  
##  <a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange  
 Chamado pelo framework quando uma propriedade de ambiente do contêiner tiver alterado o valor.  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>Parâmetros  
 *dispID*  
 A ID de expedição da propriedade de ambiente que foram alteradas, ou **DISPID_UNKNOWN** se várias propriedades foram alteradas.  
  
##  <a name="onappearancechanged"></a>COleControl::OnAppearanceChanged  
 Chamado pelo framework quando o valor da propriedade Appearance estoque foi alterado.  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função se desejar notificação após essa alteração de propriedade. A implementação padrão chama `InvalidateControl`.  
  
##  <a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged  
 Chamado pelo framework quando o valor da propriedade BackColor estoque foi alterado.  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função se desejar notificação após essa alteração de propriedade. A implementação padrão chama `InvalidateControl`.  
  
##  <a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged  
 Chamado pelo framework quando o valor da propriedade BorderStyle estoque foi alterado.  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão chama `InvalidateControl`.  
  
 Substitua essa função se desejar notificação após essa alteração de propriedade.  
  
##  <a name="onclick"></a>COleControl::OnClick  
 Chamado pelo framework quando um botão do mouse foi clicado ou o método stock de DoClick foi invocado.  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>Parâmetros  
 *iButton*  
 Índice de um botão do mouse. Pode ter um dos seguintes valores:  
  
- **LEFT_BUTTON** o botão esquerdo do mouse foi clicado.  
  
- **MIDDLE_BUTTON** o botão do meio foi clicado.  
  
- **RIGHT_BUTTON** o botão direito do mouse foi clicado.  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão chama `COleControl::FireClick`.  
  
 Substitua esta função de membro para modificar ou estender a manipulação de padrão.  
  
##  <a name="onclose"></a>COleControl::OnClose  
 Chamado pelo framework quando o contêiner é chamado de controle **IOleControl:: Close** função.  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dwSaveOption`  
 Sinalizador que indica se o objeto deve ser salvo antes de carregar. Os valores válidos são:  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>Comentários  
 Por padrão, `OnClose` salva o objeto de controle se ele tiver sido modificado e `dwSaveOption` é `OLECLOSE_SAVEIFDIRTY` ou `OLECLOSE_PROMPTSAVE`.  
  
##  <a name="ondoverb"></a>COleControl::OnDoVerb  
 Chamado pelo framework quando contêiner chama o **IOleObject:: DoVerb** função de membro.  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parâmetros  
 `iVerb`  
 O índice do verbo de controle a ser invocado.  
  
 `lpMsg`  
 Um ponteiro para a mensagem do Windows que causou o verbo a ser invocado.  
  
 `hWndParent`  
 O identificador para a janela pai do controle. Se a execução do verbo cria uma janela (ou windows), `hWndParent` deve ser usado como o pai.  
  
 `lpRect`  
 Um ponteiro para uma estrutura RECT na qual as coordenadas do controle, em relação ao contêiner, serão copiadas.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se a chamada foi bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão usa a `ON_OLEVERB` e `ON_STDOLEVERB` entradas do mapa para determinar a função adequada para invocar da mensagem.  
  
 Substitua essa função para alterar a manipulação de padrão de verbo.  
  
##  <a name="ondraw"></a>COleControl::OnDraw  
 Chamado pelo framework para desenhar o controle OLE no retângulo delimitador especificado usando o contexto de dispositivo especificado.  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pDC`  
 O contexto de dispositivo no qual ocorre o desenho.  
  
 `rcBounds`  
 A área retangular de controle, incluindo a borda.  
  
 `rcInvalid`  
 A área retangular do controle que é inválido.  
  
### <a name="remarks"></a>Comentários  
 `OnDraw`geralmente é chamado para a exibição de tela, passando um contexto de dispositivo da tela como `pDC`. O `rcBounds` parâmetro identifica o retângulo no contexto do dispositivo de destino (em relação ao modo de mapeamento atual). O `rcInvalid` parâmetro é um retângulo real que é inválido. Em alguns casos, isso será uma área menor que `rcBounds`.  
  
##  <a name="ondrawmetafile"></a>COleControl::OnDrawMetafile  
 Chamado pelo framework para desenhar o controle OLE no retângulo delimitador especificado usando o contexto de dispositivo de metarquivo especificado.  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pDC`  
 O contexto de dispositivo no qual ocorre o desenho.  
  
 `rcBounds`  
 A área retangular de controle, incluindo a borda.  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão chama o [OnDraw](#ondraw) função.  
  
##  <a name="onedit"></a>COleControl::OnEdit  
 Faz com que o controle seja ativado pela IU.  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpMsg`  
 Um ponteiro para a mensagem do Windows que invocou o verbo.  
  
 `hWndParent`  
 Um identificador para a janela pai do controle.  
  
 `lpRect`  
 Um ponteiro para o retângulo usado pelo controle no contêiner.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se a chamada for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Isso tem o mesmo efeito que invocar o controle `OLEIVERB_UIACTIVATE` verbo.  
  
 Esta função geralmente é usada como a função de manipulador para um `ON_OLEVERB` entrada de mapa de mensagem. Isso disponibiliza um verbo "Edit" no menu de "Objeto" do controle. Por exemplo:  
  
 [!code-cpp[NVC_MFCAxCtl n º 5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>COleControl::OnEnabledChanged  
 Chamado pelo framework quando o valor da propriedade Enabled de estoque é alterado.  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função se desejar notificação após essa alteração de propriedade. A implementação padrão chama [InvalidateControl](#invalidatecontrol).  
  
##  <a name="onenumverbs"></a>COleControl::OnEnumVerbs  
 Chamado pelo framework quando contêiner chama o **IOleObject::EnumVerbs** função de membro.  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>Parâmetros  
 `ppenumOleVerb`  
 Um ponteiro para o **IEnumOLEVERB** objeto que enumera os verbos do controle.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o verbo está disponível; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Enumera a implementação padrão de `ON_OLEVERB` entradas no mapa de mensagem.  
  
 Substitua essa função para alterar a forma padrão de verbos enumerar.  
  
##  <a name="oneventadvise"></a>COleControl::OnEventAdvise  
 Chamado pelo framework quando um manipulador de eventos está conectado ou desconectado de um controle OLE.  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>Parâmetros  
 `bAdvise`  
 **TRUE** indica que um manipulador de eventos está conectado ao controle. **FALSE** indica que um manipulador de eventos foi desconectado do controle.  
  
##  <a name="onfontchanged"></a>COleControl::OnFontChanged  
 Chamado pelo framework quando o valor da propriedade stock Font é alterado.  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão chama `COleControl::InvalidateControl`. Se o controle é subclasses de um controle do Windows, a implementação padrão também envia uma **WM_SETFONT** mensagem para a janela do controle.  
  
 Substitua essa função se desejar notificação após essa alteração de propriedade.  
  
### <a name="example"></a>Exemplo  
 [!code-cpp[NVC_MFCAxCtl 6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>COleControl::OnForeColorChanged  
 Chamado pelo framework quando o valor da propriedade ForeColor estoque foi alterado.  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão chama `InvalidateControl`.  
  
 Substitua essa função se desejar notificação após essa alteração de propriedade.  
  
##  <a name="onfreezeevents"></a>COleControl::OnFreezeEvents  
 Chamado pelo framework depois das chamadas de contêiner **IOleControl:: FreezeEvents**.  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>Parâmetros  
 `bFreeze`  
 **TRUE** se o controle manipulação de eventos está congelada; caso contrário **FALSE**.  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão não fará nada.  
  
 Substitua essa função se desejar comportamento adicional ao tratamento de evento está congelado ou descongelado.  
  
##  <a name="ongetcolorset"></a>COleControl::OnGetColorSet  
 Chamado pelo framework quando contêiner chama o **IViewObject::GetColorSet** função de membro.  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>Parâmetros  
 `ptd`  
 Aponta para o dispositivo de destino para o qual a imagem deve ser processada. Se esse valor for **nulo**, a imagem deve ser processada para um dispositivo de destino padrão, geralmente um dispositivo de vídeo.  
  
 `hicTargetDev`  
 Especifica o contexto de informações no dispositivo de destino indicado pelo `ptd`. Esse parâmetro pode ser um contexto de dispositivo, mas não é necessariamente. If `ptd` is **NULL**, `hicTargetDev` should also be **NULL**.  
  
 *ppColorSet*  
 Um ponteiro para o local em que o conjunto de cores que seria usado deve ser copiado. Se a função não retorna o conjunto de cores, **nulo** é retornado.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for retornado um conjunto de cores válidos; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 O contêiner chama esta função para obter todas as cores necessárias para desenhar o controle OLE. O contêiner pode usar os conjuntos de cor obtidos em conjunto com as cores necessárias para definir a paleta de cores geral. A implementação padrão retorna **FALSE**.  
  
 Substitua essa função para fazer qualquer processamento especial dessa solicitação.  
  
##  <a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo  
 Chamado pelo framework quando o contêiner do controle solicitou informações sobre o controle.  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pControlInfo`  
 Ponteiro para um [CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734) estrutura a ser preenchido.  
  
### <a name="remarks"></a>Comentários  
 Essas informações consistem principalmente em uma descrição das chaves mnemônica do controle. Preencher a implementação padrão `pControlInfo` com informações padrão.  
  
 Substitua essa função se o seu controle precisa processar chaves mnemônicos.  
  
##  <a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString  
 Chamado pelo framework para obter uma cadeia de caracteres que representa o valor atual da propriedade identificado por `dispid`.  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dispid`  
 A ID de expedição de uma propriedade do controle.  
  
 `strValue`  
 Uma referência a um [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto por meio do qual uma cadeia de caracteres será retornada.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se uma cadeia de caracteres foi retornada em *strValue;* caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função se o controle possui uma propriedade cujo valor não pode ser convertido diretamente em uma cadeia de caracteres e você desejar que o valor da propriedade a ser exibida em um navegador de propriedade fornecido pelo contêiner.  
  
##  <a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu  
 Chamado pelo framework quando o controle é ativado para obter o menu a ser mesclada em menus existentes do contêiner de interface do usuário.  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>Valor de retorno  
 O identificador do menu de controle, ou **nulo** se o controle não tiver nenhum. A implementação padrão retorna **nulo**.  
  
### <a name="remarks"></a>Comentários  
 Para obter mais informações sobre a mesclagem dos recursos OLE, consulte o artigo [Menus e recursos OLE](../../mfc/menus-and-resources-ole.md).  
  
##  <a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent  
 Chamado pelo framework em resposta a um contêiner **IViewObjectEx::GetNaturalExtent** solicitação.  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dwAspect`  
 Especifica como o objeto deve ser representado. Representações incluem conteúdo, um ícone, uma miniatura ou um documento impresso. Os valores válidos são obtidos de enumeração [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**.  
  
 *lindex*  
 A parte do objeto que é de interesse. -1 no momento, somente é válido.  
  
 `ptd`  
 Aponta para o [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) estrutura definindo o dispositivo de destino para o qual o tamanho do objeto deve ser retornado.  
  
 `hicTargetDev`  
 Especifica as informações de contexto para o dispositivo de destino indicado pelo `ptd` parâmetro do qual o objeto pode extrair métricas de dispositivo e testar os recursos do dispositivo. Se `ptd` é **nulo**, o objeto deve ignorar o valor de `hicTargetDev` parâmetro.  
  
 *pExtentInfo*  
 Aponta para o **DVEXTENTINFO** estrutura que especifica os dados de dimensionamento. O **DVEXTENTINFO** estrutura é:  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 O membro de estrutura `dwExtentMode` pode assumir um dos dois valores:  
  
- **DVEXTENT_CONTENT** consultar o tamanho máximo que o controle deve ser exatamente caber conteúdo (snap para tamanho)  
  
- **DVEXTENT_INTEGRAL** ao redimensionar, passe o tamanho proposto para controle  
  
 `psizel`  
 Pontos de dados retornados pelo controle de tamanho. Os dados retornados de dimensionamento são definidos como -1 para todas as dimensões não foi ajustada.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se ele retorna com êxito ou ajusta o tamanho. Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Substituir essa função para retornar o tamanho de exibição do objeto mais próximo do tamanho e a extensão no modo proposto no **DVEXTENTINFO** estrutura. A implementação padrão retorna **FALSE** e não faz com que nenhum ajuste de tamanho.  
  
##  <a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings  
 Chamado pelo framework para obter um conjunto de cadeias de caracteres predefinidas que representa os possíveis valores para uma propriedade.  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dispid`  
 A ID de expedição de uma propriedade do controle.  
  
 `pStringArray`  
 Uma matriz de cadeia de caracteres a ser preenchida com valores de retorno.  
  
 `pCookieArray`  
 A `DWORD` matriz a ser preenchida com valores de retorno.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se elementos foram adicionados ao `pStringArray` e `pCookieArray`.  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função se o controle possui uma propriedade com um conjunto de valores possíveis que podem ser representadas por cadeias de caracteres. Para cada elemento adicionado ao `pStringArray`, você deve adicionar um elemento correspondente "cookie" *pCookieArray.* Esses valores de "cookies" posteriormente podem ser passados pelo framework para o `COleControl::OnGetPredefinedValue` função.  
  
##  <a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue  
 Chamado pelo framework para obter o valor correspondente a uma das cadeias de caracteres predefinidas anteriormente retornadas por uma substituição de `COleControl::OnGetPredefinedStrings`.  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dispid`  
 A ID de expedição de uma propriedade do controle.  
  
 `dwCookie`  
 Um valor de cookie anteriormente retornado por uma substituição de `COleControl::OnGetPredefinedStrings`.  
  
 `lpvarOut`  
 Ponteiro para um **VARIANT** estrutura por meio da qual um valor de propriedade será retornado.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se um valor foi retornado em `lpvarOut`; caso contrário, 0.  
  
##  <a name="ongetviewextent"></a>COleControl::OnGetViewExtent  
 Chamado pelo framework em resposta a um contêiner [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) solicitação.  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>Parâmetros  
 *dwDrawAspect*  
 `DWORD`Descrever o formulário ou a proporção, de um objeto é exibido. Os valores válidos são obtidos de enumeração [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**.  
  
 *lindex*  
 A parte do objeto que é de interesse. -1 no momento, somente é válido.  
  
 `ptd`  
 Aponta para o [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) estrutura definindo o dispositivo de destino para o qual o tamanho do objeto deve ser retornado.  
  
 *lpsizel*  
 Aponta para o local em que o tamanho do objeto é retornado.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se informações de extensão são retornadas com êxito; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função se o controle usa dois passos desenho e suas partes opacos e transparentes têm dimensões diferentes.  
  
##  <a name="ongetviewrect"></a>COleControl::OnGetViewRect  
 Chamado pelo framework em resposta a um contêiner **IViewObjectEx::GetRect** solicitação.  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dwAspect`  
 `DWORD`Descrever o formulário ou a proporção, de um objeto é exibido. Os valores válidos são obtidos de enumeração [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**:  
  
- `DVASPECT_CONTENT`Retângulo delimitador de todo o objeto. O canto superior esquerdo na origem do objeto e de tamanho igual a extensão retornado por **GetViewExtent***.*  
  
- **DVASPECT_OPAQUE** objetos com uma região de opaco retangular retornam esse retângulo. Outras que apresentam falhas.  
  
- **DVASPECT_TRANSPARENT** retângulo que abrangem todas as partes transparentes ou irregulares.  
  
 `pRect`  
 Aponta para o [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) estrutura especificando o retângulo na qual o objeto deve ser desenhado. Este parâmetro controla o posicionamento e alongamento do objeto.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o retângulo de tamanho para o objeto é retornado com êxito; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Tamanho do objeto é convertido pelo `OnGetViewRect` em um retângulo que começa em uma posição específica (o padrão é o canto superior esquerdo da tela). Substitua essa função se o controle usa dois passos desenho e suas partes opacos e transparentes têm dimensões diferentes.  
  
##  <a name="ongetviewstatus"></a>COleControl::OnGetViewStatus  
 Chamado pelo framework em resposta a um contêiner **IViewObjectEx::GetViewStatus** solicitação.  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Um dos valores da **VIEWSTATUS** enumeração se bem-sucedido; caso contrário, 0. Os valores possíveis são qualquer combinação das seguintes opções:  
  
 **VIEWSTATUS_OPAQUE**  
 O objeto é completamente opaco. Se este bit não for definido, o objeto contém partes transparentes. Esse bit aplica-se somente aos aspectos relacionados ao conteúdo e não a `DVASPECT_ICON` ou `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_SOLIDBKGND**  
 O objeto tem um plano de fundo sólido (consistindo em uma cor sólida, não é um padrão de pincel). Esse bit é significativo somente se **VIEWSTATUS_OPAQUE** está definido e se aplica somente aos aspectos relacionados ao conteúdo e não a `DVASPECT_ICON` ou `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 Objeto oferece suporte a **DVASPECT_OPAQUE**. Todos os **IViewObjectEx** métodos que usam um aspecto do desenho como um parâmetro pode ser chamado com esse aspecto.  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 Objeto oferece suporte a **DVASPECT_TRANSPARENT**. Todos os **IViewObjectEx** métodos que usam um aspecto do desenho como um parâmetro pode ser chamado com esse aspecto.  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função se o seu controle usa dois passos desenho. A implementação padrão retorna **VIEWSTATUS_OPAQUE**.  
  
##  <a name="onhidetoolbars"></a>COleControl::OnHideToolBars  
 Chamado pelo framework quando o controle é desativado pela IU.  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>Comentários  
 A implementação deve ocultar todas as barras de ferramentas exibidas pelo `OnShowToolbars`.  
  
##  <a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove  
 Chamado pelo contêiner para o objeto inativo sob o ponteiro do mouse no recebimento de uma `WM_MOUSEMOVE` mensagem.  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lprcBounds`  
 O objeto delimitadora retângulo, nas coordenadas do cliente da janela. Informa o objeto de seu tamanho e a posição exata na tela quando o `WM_MOUSEMOVE` mensagem foi recebida.  
  
 *x*  
 A coordenada x do local do mouse em coordenadas do cliente da janela.  
  
 *y*  
 A coordenada y do local do mouse em coordenadas do cliente da janela.  
  
 `dwKeyState`  
 Identifica o estado atual das teclas modificadoras do teclado. Os valores válidos podem ser uma combinação de qualquer um dos sinalizadores **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_BUTTON**, **MK_LBUTTON**, **MK_MBUTTON**, e **MK_RBUTTON**.  
  
### <a name="remarks"></a>Comentários  
 Observe que as coordenadas do cliente de janela (em pixels) são usadas para passar a posição do cursor do mouse. Isso é possibilitado passando também o retângulo delimitador do objeto no mesmo sistema de coordenadas.  
  
##  <a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor  
 Chamado pelo contêiner para o objeto inativo sob o ponteiro do mouse no recebimento de uma `WM_SETCURSOR` mensagem.  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lprcBounds`  
 O objeto delimitadora retângulo, nas coordenadas do cliente da janela. Informa o objeto de seu tamanho e a posição exata na tela quando o `WM_SETCURSOR` mensagem foi recebida.  
  
 *x*  
 A coordenada x do local do mouse em coordenadas do cliente da janela.  
  
 *y*  
 A coordenada y do local do mouse em coordenadas do cliente da janela.  
  
 *dwMouseMsg*  
 O identificador da mensagem do mouse para o qual um `WM_SETCURSOR` ocorreu.  
  
 *bSetAlways*  
 Especifica se o objeto deve definir o cursor. Se **TRUE**, o objeto deve definir o cursor; se **FALSE**, o cursor não é obrigado a definir o cursor e deve retornar **S_FALSE** nesse caso.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Observe que as coordenadas do cliente de janela (em pixels) são usadas para passar a posição do cursor do mouse. Isso é possibilitado passando também o retângulo delimitador do objeto no mesmo sistema de coordenadas.  
  
##  <a name="onkeydownevent"></a>COleControl::OnKeyDownEvent  
 Chamado pelo framework depois que um evento KeyDown estoque foi processado.  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Parâmetros  
 `nChar`  
 O valor de código de tecla virtual da tecla pressionada. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser  
  
 `nShiftState`  
 Contém uma combinação dos sinalizadores a seguir:  
  
- **SHIFT_MASK** foi pressionada a tecla SHIFT durante a ação.  
  
- **CTRL_MASK** CTRL a tecla foi pressionada durante a ação.  
  
- **ALT_MASK** ALT a tecla foi pressionada durante a ação.  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função se o controle precisa acessar as informações da chave depois que o evento foi acionado.  
  
##  <a name="onkeypressevent"></a>COleControl::OnKeyPressEvent  
 Chamado pelo framework após o evento KeyPress foi acionado de estoque.  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>Parâmetros  
 `nChar`  
 Contém o valor de código de tecla virtual da tecla pressionada. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser  
  
### <a name="remarks"></a>Comentários  
 Observe que o `nChar` valor pode ter sido modificado pelo contêiner.  
  
 Substitua essa função se desejar notificação após esse evento ocorre.  
  
##  <a name="onkeyupevent"></a>COleControl::OnKeyUpEvent  
 Chamado pelo framework depois que um evento KeyDown estoque foi processado.  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Parâmetros  
 `nChar`  
 O valor de código de tecla virtual da tecla pressionada. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser  
  
 `nShiftState`  
 Contém uma combinação dos sinalizadores a seguir:  
  
- **SHIFT_MASK** foi pressionada a tecla SHIFT durante a ação.  
  
- **CTRL_MASK** CTRL a tecla foi pressionada durante a ação.  
  
- **ALT_MASK** ALT a tecla foi pressionada durante a ação.  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função se o controle precisa acessar as informações da chave depois que o evento foi acionado.  
  
##  <a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage  
 Chamado pelo framework para obter a ID de classe de uma página de propriedade que implementa a edição da propriedade especificada.  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dispid`  
 A ID de expedição de uma propriedade do controle.  
  
 `lpclsid`  
 Ponteiro para um **CLSID** estrutura por meio da qual uma ID de classe será retornada.  
  
 *pbPageOptional*  
 Retorna um indicador de se o uso da página de propriedades especificada é opcional.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se uma ID de classe foi retornada em `lpclsid`; caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Substitua essa função para fornecer uma maneira de invocar as páginas de propriedade do controle de navegador de propriedade do contêiner.  
  
##  <a name="onmnemonic"></a>COleControl::OnMnemonic  
 Chamado pelo framework quando o contêiner detectou que uma tecla mnemônica do controle OLE foi pressionada.  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pMsg`  
 Ponteiro para a mensagem gerada por um pressionamento de tecla mnemônico do Windows.  
  
##  <a name="onproperties"></a>COleControl::OnProperties  
 Chamado pelo framework quando o verbo de propriedades do controle foi chamado pelo contêiner.  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpMsg`  
 Um ponteiro para a mensagem do Windows que invocou o verbo.  
  
 `hWndParent`  
 Um identificador para a janela pai do controle.  
  
 `lpRect`  
 Um ponteiro para o retângulo usado pelo controle no contêiner.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se a chamada for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão exibe uma caixa de diálogo de propriedades restrita.  
  
 Você também pode usar essa função para fazer com que a exibição das páginas de propriedades do controle. Fazer uma chamada para o `OnProperties` função, passando o identificador do pai do controle no `hWndParent` parâmetro. Nesse caso, os valores de `lpMsg` e `lpRect` parâmetros serão ignorados.  
  
##  <a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint  
 Chamado pelo framework em resposta a um contêiner **IViewObjectEx::QueryHitPoint** solicitação.  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dwAspect`  
 Especifica como o objeto é representado. Os valores válidos são obtidos de enumeração [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**.  
  
 `pRectBounds`  
 Ponteiro para um `RECT` estrutura especificando o retângulo delimitador da área de cliente de controle OLE.  
  
 `ptlLoc`  
 Ponteiro para o **ponto** estrutura especificando o ponto a ser verificada para uma ocorrência. O ponto é especificado nas coordenadas da área cliente OLE.  
  
 `lCloseHint`  
 A distância que define "Fechar" para o ponto de check ocorrência.  
  
 `pHitResult`  
 Ponteiro para o resultado da consulta de ocorrências. Um dos seguintes valores:  
  
- **HITRESULT_OUTSIDE** `ptlLoc` está fora do OLE do objeto e não fechada.  
  
- **HITRESULT_TRANSPARENT** *ptlLoc* está dentro dos limites do objeto OLE, mas não próximo a imagem. Por exemplo, um ponto no meio de um círculo transparente poderia ser **HITRESULT_TRANSPARENT**.  
  
- **HITRESULT_CLOSE** `ptlLoc` está dentro ou fora do objeto OLE, mas fechar o suficiente para o objeto a ser considerado dentro. Objetos pequenos, dinâmico ou detalhados podem usar esse valor. Mesmo se um ponto está fora do limite retângulo de um objeto pode ainda ser fechar (Isso é necessário para atingir os objetos pequenos).  
  
- **HITRESULT_HIT** `ptlLoc` está dentro da imagem do objeto.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se um resultado de ocorrência é retornado com êxito; Caso contrário, 0. Um acerto é uma sobreposição com a área de exibição de controle OLE.  
  
### <a name="remarks"></a>Comentários  
 Consulta se o retângulo de exibição de um objeto se sobrepõe a determinado ponto (atinge o ponto). `QueryHitPoint`pode ser substituído para testar ocorrências para objetos não retangulares.  
  
##  <a name="onqueryhitrect"></a>COleControl::OnQueryHitRect  
 Chamado pelo framework em resposta a um contêiner **IViewObjectEx::QueryHitRect** solicitação.  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dwAspect`  
 Especifica como o objeto deve ser representado. Os valores válidos são obtidos de enumeração [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**.  
  
 `pRectBounds`  
 Ponteiro para um `RECT` estrutura especificando o retângulo delimitador da área de cliente de controle OLE.  
  
 *prcLoc*  
 Ponteiro para o `RECT` estrutura especificando o retângulo a ser verificada para uma ocorrência (sobreposição com o retângulo de objeto), em relação ao canto superior esquerdo do objeto.  
  
 `lCloseHint`  
 Não usado.  
  
 `pHitResult`  
 Ponteiro para o resultado da consulta de ocorrências. Um dos seguintes valores:  
  
- **HITRESULT_OUTSIDE** nenhum ponto no retângulo é atingido, o objeto OLE.  
  
- **HITRESULT_HIT** pelo menos um ponto no retângulo seria um impacto no objeto.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se um resultado de ocorrência é retornado com êxito; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Consulta se o retângulo de exibição de um objeto se sobrepõe a qualquer ponto no retângulo determinado (atinge o retângulo). `QueryHitRect`pode ser substituído para testar ocorrências para objetos não retangulares.  
  
##  <a name="onrenderdata"></a>COleControl::OnRenderData  
 Chamado pelo framework para recuperar dados no formato especificado.  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpFormatEtc`  
 Aponta para o [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estrutura especificando o formato no qual as informações são solicitadas.  
  
 `lpStgMedium`  
 Aponta para um [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) estrutura na qual os dados são a ser retornado.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 O formato especificado é um previamente colocadas no objeto de controle usando o [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) ou [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) funções de membro para renderização atrasada. A implementação padrão Esta função chama `OnRenderFileData` ou `OnRenderGlobalData`, respectivamente, se a mídia de armazenamento fornecido é um arquivo ou memória. Se o formato solicitado é `CF_METAFILEPICT` ou formato de definir a propriedade persistente, a implementação padrão renderiza os dados apropriados e retorna zero. Caso contrário, ele retorna 0 e não faz nada.  
  
 Se *lpStgMedium-> tymed* é **TYMED_NULL**, o **STGMEDIUM** deve ser alocada e preenchido conforme especificado pelas *lpFormatEtc-> tymed*. Se não **TYMED_NULL**, o **STGMEDIUM** devem ser preenchidos local com os dados.  
  
 Substitua essa função para fornecer seus dados no formato solicitado e média. Dependendo de seus dados, convém substituir uma das versões dessa função em vez disso. Se os dados forem pequenos e de tamanho fixo, substituir `OnRenderGlobalData`. Se os dados estão em um arquivo ou de tamanho variável, substituir `OnRenderFileData`.  
  
 Para obter mais informações, consulte o **FORMATETC** e **STGMEDIUM** estruturas de [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onrenderfiledata"></a>COleControl::OnRenderFileData  
 Chamado pelo framework para recuperar dados no formato especificado quando a mídia de armazenamento é um arquivo.  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpFormatEtc`  
 Aponta para o [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estrutura especificando o formato no qual as informações são solicitadas.  
  
 `pFile`  
 Aponta para um [CFile](../../mfc/reference/cfile-class.md) objeto no qual os dados são a ser processado.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 O formato especificado é um previamente colocadas no objeto de controle usando o [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) a função de membro para renderização atrasada. A implementação padrão dessa função simplesmente retorna **FALSE**.  
  
 Substitua essa função para fornecer seus dados no formato solicitado e média. Dependendo de seus dados, talvez você queira substituir uma das versões dessa função em vez disso. Se você desejar tratar vários meios de armazenamento, substitua `OnRenderData`. Se os dados estão em um arquivo ou de tamanho variável, substituir `OnRenderFileData`.  
  
 Para obter mais informações, consulte o **FORMATETC** estrutura no [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData  
 Chamado pelo framework para recuperar dados no formato especificado quando a mídia de armazenamento especificado é memória global.  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpFormatEtc`  
 Aponta para o [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estrutura especificando o formato no qual as informações são solicitadas.  
  
 `phGlobal`  
 Aponta para um identificador para a memória global no qual os dados são a ser retornado. Se nenhuma memória foi alocada, esse parâmetro pode ser **nulo**.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 O formato especificado é um previamente colocadas no objeto de controle usando o [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) a função de membro para renderização atrasada. A implementação padrão dessa função simplesmente retorna **FALSE**.  
  
 Se `phGlobal` é **nulo**, em seguida, um novo `HGLOBAL` deve ser alocada e retornados em `phGlobal`. Caso contrário, o `HGLOBAL` especificado por `phGlobal` deve ser preenchido com os dados. A quantidade de dados colocados no `HGLOBAL` não deve exceder o tamanho atual do bloco de memória. Além disso, o bloco não pode ser realocado para um tamanho maior.  
  
 Substitua essa função para fornecer seus dados no formato solicitado e média. Dependendo de seus dados, convém substituir uma das versões dessa função em vez disso. Se você desejar tratar vários meios de armazenamento, substitua `OnRenderData`. Se os dados estão em um arquivo ou de tamanho variável, substituir `OnRenderFileData`.  
  
 Para obter mais informações, consulte o **FORMATETC** estrutura no [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onresetstate"></a>COleControl::OnResetState  
 Chamado pelo framework quando as propriedades do controle devem ser definidas para seus valores padrão.  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão chama [DoPropExchange](#dopropexchange), passando um `CPropExchange` objeto que faz com que propriedades sejam definidas para seus valores padrão.  
  
 O gravador de controle pode inserir o código de inicialização para o controle OLE neste substituível. Essa função é chamada quando [IPersistStream::Load](http://msdn.microsoft.com/library/windows/desktop/ms680568) ou [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) falhar, ou [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) ou [IPersistStorage::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) é chamado, sem primeiro chamar **IPersistStream::Load** ou **IPersistStorage::Load**.  
  
##  <a name="onsetclientsite"></a>COleControl::OnSetClientSite  
 Chamado pelo framework quando o contêiner é chamado de controle **IOleControl::SetClientSite** função.  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>Comentários  
 Por padrão, `OnSetClientSite` verifica se as propriedades de caminho de dados são carregadas e, se estiverem, chama `DoDataPathPropExchange`.  
  
 Substitua essa função para fazer qualquer processamento especial dessa notificação. Em particular, as substituições dessa função devem chamar a classe base.  
  
##  <a name="onsetdata"></a>COleControl::OnSetData  
 Chamado pelo framework para substituir os dados do controle com os dados especificados.  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpFormatEtc`  
 Ponteiro para um [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estrutura especificando o formato dos dados.  
  
 `lpStgMedium`  
 Ponteiro para um [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) estrutura na qual os dados residem.  
  
 `bRelease`  
 **TRUE** se o controle deve liberar a mídia de armazenamento; **FALSE** se o controle não deve liberar a mídia de armazenamento.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Se os dados é na propriedade persistente de formato definidos, a implementação padrão modifica o estado do controle de forma adequada. Caso contrário, a implementação padrão não fará nada. Se `bRelease` é **TRUE**, em seguida, uma chamada para **ReleaseStgMedium** é feita; caso contrário, não.  
  
 Substitua essa função para substituir os dados do controle com os dados especificados.  
  
 Para obter mais informações, consulte o **FORMATETC** e **STGMEDIUM** estruturas de [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onsetextent"></a>COleControl::OnSetExtent  
 Chamado pelo framework quando a extensão do controle precisa ser alterado, como resultado de uma chamada para [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330).  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpSizeL`  
 Um ponteiro para o **como** estrutura que usa inteiros longos para representar a largura e altura do controle, expressada em **HIMETRIC** unidades.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se a alteração de tamanho foi aceita; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão manipula o redimensionamento de extensão do controle. Se o controle está ativo no local, uma chamada para o contêiner **OnPosRectChanged** é feita.  
  
 Substitua essa função para alterar o padrão de redimensionamento do seu controle.  
  
##  <a name="onsetobjectrects"></a>COleControl::OnSetObjectRects  
 Chamado pelo framework para implementar uma chamada para [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767).  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>Parâmetros  
 *lpRectPos*  
 Um ponteiro para uma estrutura RECT que indica a nova posição do controle e o tamanho relativo do contêiner.  
  
 `lpRectClip`  
 Um ponteiro para um `RECT` estrutura indicando uma área retangular ao qual o controle é recortada.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se o reposicionamento foi aceita; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão automaticamente trata o reposicionamento e redimensionamento de janela de controle e retorna **TRUE**.  
  
 Substitua esta função para alterar o comportamento padrão dessa função.  
  
##  <a name="onshowtoolbars"></a>COleControl::OnShowToolBars  
 Chamado pelo framework quando o controle foi ativado pela IU.  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão não fará nada.  
  
##  <a name="ontextchanged"></a>COleControl::OnTextChanged  
 Chamado pelo framework quando o valor da propriedade legenda ou texto estoque foi alterado.  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão chama `InvalidateControl`.  
  
 Substitua essa função se desejar notificação após essa alteração de propriedade.  
  
##  <a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage  
 Chamado pelo framework em resposta a um contêiner **IOleInPlaceObjectWindowless::OnWindowMessage** solicitação.  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>Parâmetros  
 `msg`  
 Identificador de mensagem passados pelo Windows.  
  
 `wParam`  
 Passados pelo Windows. Especifica informações adicionais de mensagem específica. O conteúdo deste parâmetro depende do valor da `msg` parâmetro.  
  
 `lParam`  
 Passados pelo Windows. Especifica informações adicionais de mensagem específica. O conteúdo deste parâmetro depende do valor da `msg` parâmetro.  
  
 *plResult*  
 Código de resultado do Windows. Especifica o resultado do processamento de mensagem e depende da mensagem enviada.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Processa as mensagens de janela para controles sem janelas. `COleControl`do `OnWindowlessMessage` deve ser usado para mensagens de janela diferentes mensagens de mouse e teclado. `COleControl`Fornece [SetCapture](#setcapture) e [SetFocus](#setfocus) especificamente para obter o foco de teclado e captura do mouse para os objetos OLE sem janelas.  
  
 Como objetos sem janelas não tem uma janela, eles precisam de um mecanismo para permitir que as mensagens de expedição de contêiner a eles. Um objeto OLE sem janelas obtém mensagens de seu contêiner, por meio de `OnWindowMessage` método no `IOleInPlaceObjectWindowless` interface (uma extensão de [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) para suporte sem janelas). `OnWindowMessage`não tem um `HWND` parâmetro.  
  
##  <a name="parenttoclient"></a>COleControl::ParentToClient  
 Converte as coordenadas de `pPoint` nas coordenadas do cliente.  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>Parâmetros  
 `lprcBounds`  
 Ponteiro para os limites do controle OLE dentro do contêiner. A área de todo o controle incluindo bordas e barras de rolagem, mas não a área do cliente.  
  
 `pPoint`  
 Ponteiro para o pai (contêiner) aponte para ser convertido em coordenadas da área cliente do controle.  
  
 `bHitTest`  
 Especifica se é ou não teste de clique a ser feito no ponto de.  
  
### <a name="return-value"></a>Valor de retorno  
 Se `bHitTest` é **FALSE**, retorna **HTNOWHERE**. Se `bHitTest` é **TRUE**, retorna o local em que o pai (contêiner) aponte descarregou na área cliente do controle OLE e é um dos seguinte mouse valores de teste de hit:  
  
- **HTBORDER** na borda de uma janela que não tem uma borda de dimensionamento.  
  
- **HTBOTTOM** na horizontal borda inferior da janela.  
  
- **HTBOTTOMLEFT** no canto inferior esquerdo da borda da janela.  
  
- **HTBOTTOMRIGHT** no canto inferior direito da borda da janela.  
  
- **HTCAPTION** em uma área de barra de título.  
  
- **HTCLIENT** em uma área do cliente.  
  
- **HTERROR** no plano de fundo de tela ou em uma linha divisória entre as janelas (mesmo que **HTNOWHERE** exceto que o **DefWndProc** função Windows produz um bipe do sistema para indicar um erro).  
  
- **HTGROWBOX** em uma caixa de tamanho.  
  
- **HTHSCROLL** na barra de rolagem horizontal.  
  
- **HTLEFT** na borda esquerda da janela.  
  
- **HTMAXBUTTON** em maximizar a um botão.  
  
- **HTMENU** em uma área de menu.  
  
- **HTMINBUTTON** a minimizar o botão.  
  
- **HTNOWHERE** no plano de fundo de tela ou em uma linha divisória entre as janelas.  
  
- **HTREDUCE** a minimizar o botão.  
  
- **HTRIGHT** na borda direita da janela.  
  
- **HTSIZE** em uma caixa de tamanho (mesmo que **HTGROWBOX**).  
  
- **HTSYSMENU** em um menu de controle ou em um botão Fechar uma janela filho.  
  
- **HTTOP** na borda superior horizontal da janela.  
  
- **HTTOPLEFT** no canto superior esquerdo da borda da janela.  
  
- **HTTOPRIGHT** no canto superior direito da borda da janela.  
  
- **HTTRANSPARENT** em uma janela está coberta por outra janela.  
  
- **HTVSCROLL** na barra de rolagem vertical.  
  
- **HTZOOM** em maximizar a um botão.  
  
### <a name="remarks"></a>Comentários  
 Na entrada `pPoint` é relativo à origem do pai (canto superior esquerdo do contêiner). Na saída `pPoint` é relativo à origem da área cliente do controle OLE (canto superior esquerdo da área cliente do controle).  
  
##  <a name="postmodaldialog"></a>COleControl::PostModalDialog  
 Notifica o contêiner que uma caixa de diálogo modal foi fechada.  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Parâmetros  
 `hWndParent`  
 Identificador para a janela pai da caixa de diálogo modal.  
  
### <a name="remarks"></a>Comentários  
 Chame essa função depois de exibir qualquer caixa de diálogo modal. Você deve chamar essa função para que o contêiner pode habilitar quaisquer janelas de nível superior desabilitadas por `PreModalDialog`. Essa função deve ser combinada com uma chamada para `PreModalDialog`.  
  
##  <a name="premodaldialog"></a>COleControl::PreModalDialog  
 Notifica o contêiner que uma caixa de diálogo modal está prestes a ser exibido.  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Parâmetros  
 `hWndParent`  
 Identificador para a janela pai da caixa de diálogo modal.  
  
### <a name="remarks"></a>Comentários  
 Chame essa função antes de exibir qualquer caixa de diálogo modal. Você deve chamar essa função para que o contêiner pode desabilitar todas as suas janelas de nível superior. Depois que a caixa de diálogo modal foi exibida, em seguida, você deve chamar `PostModalDialog`.  
  
##  <a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow  
 Destrói e recria a janela do controle.  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>Comentários  
 Isso pode ser necessário se você precisar alterar os bits de estilo da janela.  
  
##  <a name="refresh"></a>COleControl::Refresh  
 Força um redesenho do controle OLE.  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>Comentários  
 Essa função é suportada pelo `COleControl` classe base como um método de estoque, chamado de atualização. Isso permite que os usuários do seu controle OLE redesenhar o controle em um momento específico. Para obter mais informações sobre esse método, consulte o artigo [controles ActiveX: métodos](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="releasecapture"></a>COleControl::ReleaseCapture  
 Libera a captura do mouse.  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Se o controle tem a captura do mouse, a captura é liberada. Caso contrário, essa função não tem efeito.  
  
##  <a name="releasedc"></a>COleControl::ReleaseDC  
 Libera o contexto de dispositivo de exibição de um contêiner de um controle sem janelas, liberando o contexto de dispositivo para uso por outros aplicativos.  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pDC`  
 Identifica o contexto de dispositivo do contêiner a ser liberado.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se for bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 O aplicativo deve chamar `ReleaseDC` para cada chamada para [GetDC](#getdc).  
  
##  <a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow  
 Define o pai do controle.  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>Parâmetros  
 *hWndOuter*  
 O identificador da janela do controle.  
  
 `hWndParent`  
 O identificador da nova janela pai.  
  
### <a name="remarks"></a>Comentários  
 Chame essa função para redefinir o pai da janela do controle.  
  
##  <a name="resetstockprops"></a>COleControl::ResetStockProps  
 Inicializa o estado do `COleControl` stock propriedades com seus valores padrão.  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>Comentários  
 As propriedades são: aparência, BackColor, BorderStyle, legenda, habilitado, fonte, cor de primeiro plano, hWnd e texto. Para obter uma descrição de propriedades de estoque, consulte [controles ActiveX: Adicionando propriedades de estoque](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Você pode melhorar o desempenho de inicialização binário do controle usando `ResetStockProps` e `ResetVersion` para substituir `COleControl::OnResetState`. Consulte o exemplo abaixo. Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: otimização](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Exemplo  
 [!code-cpp[NVC_MFCAxCtl #7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>COleControl::ResetVersion  
 Inicializa o número de versão para o valor especificado.  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>Parâmetros  
 `dwVersionDefault`  
 O número de versão a ser atribuído ao controle.  
  
### <a name="remarks"></a>Comentários  
 Você pode melhorar o desempenho de inicialização binário do controle usando `ResetVersion` e `ResetStockProps` para substituir `COleControl::OnResetState`. Consulte o exemplo em [ResetStockProps](#resetstockprops). Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: otimização](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="scrollwindow"></a>COleControl::ScrollWindow  
 Permite que um objeto OLE sem janelas rolar uma área dentro de sua imagem ativa no local na tela.  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>Parâmetros  
 `xAmount`  
 Especifica a quantidade, em unidades de dispositivo, da rolagem horizontal. Esse parâmetro deve ser um valor negativo para rolar para a esquerda.  
  
 `yAmount`  
 Especifica a quantidade, em unidades de dispositivo de rolagem vertical. Esse parâmetro deve ser um valor negativo para rolar para cima.  
  
 `lpRect`  
 Aponta para um [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto ou estrutura RECT que especifica a parte da área do cliente do objeto OLE para rolar, nas coordenadas do cliente da janela. Se `lpRect` é **nulo**, área de cliente do objeto OLE inteiro é rolada.  
  
 `lpClipRect`  
 Aponta para um `CRect` objeto ou `RECT` estrutura que especifica o retângulo de recorte para. Estiverem somente pixels dentro do retângulo. Bits fora do retângulo não são afetadas, mesmo se eles estiverem no `lpRect` retângulo. Se `lpClipRect` é **nulo**, sem recorte é executado no retângulo de rolagem.  
  
##  <a name="selectfontobject"></a>COleControl::SelectFontObject  
 Seleciona uma fonte em um contexto de dispositivo.  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pDC`  
 Ponteiro para um objeto de contexto de dispositivo.  
  
 `fontHolder`  
 Referência para o [CFontHolder](../../mfc/reference/cfontholder-class.md) objeto que representa a fonte a ser selecionado.  
  
### <a name="return-value"></a>Valor de retorno  
 Um ponteiro para a fonte selecionada anteriormente. Quando o chamador concluiu todas as operações de desenho que usam *fontHolder,* devem selecionar novamente a fonte selecionada anteriormente, passando-o como um parâmetro para [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).  
  
##  <a name="selectstockfont"></a>COleControl::SelectStockFont  
 Seleciona a propriedade Font estoque em um contexto de dispositivo.  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pDC`  
 O contexto de dispositivo no qual a fonte será selecionada.  
  
### <a name="return-value"></a>Valor de retorno  
 Um ponteiro para selecionado anteriormente `CFont` objeto. Você deve usar [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) para selecionar essa fonte no contexto do dispositivo quando tiver terminado.  
  
##  <a name="serializeextent"></a>COleControl::SerializeExtent  
 Serializa ou inicializa o estado do vídeo espaço alocado para o controle.  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>Parâmetros  
 `ar`  
 Um `CArchive` objeto a ser serializado para ou do.  
  
### <a name="remarks"></a>Comentários  
 Você pode melhorar o desempenho de persistência binário do controle usando `SerializeExtent`, `SerializeStockProps`, e `SerializeVersion` para substituir **COleControl::Serialize**. Consulte o exemplo abaixo. Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: otimização](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Exemplo  
 [!code-cpp[NVC_MFCAxCtl n º 8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>COleControl::SerializeStockProps  
 Serializa ou inicializa o estado do `COleControl` propriedades de estoque: aparência, BackColor, BorderStyle, legenda, habilitado, fonte, cor de primeiro plano e texto.  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>Parâmetros  
 `ar`  
 Um `CArchive` objeto a ser serializado para ou do.  
  
### <a name="remarks"></a>Comentários  
 Para obter uma descrição de propriedades de estoque, consulte [controles ActiveX: Adicionando propriedades de estoque](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Você pode melhorar o desempenho de persistência binário do controle usando `SerializeStockProps`, `SerializeExtent`, e `SerializeVersion` para substituir **COleControl::Serialize**. Para obter um exemplo, consulte o código em [SerializeExtent](#serializeextent). Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: otimização](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="serializeversion"></a>COleControl::SerializeVersion  
 Serializa ou inicializa o estado das informações de versão do controle.  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Parâmetros  
 `ar`  
 Um `CArchive` objeto a ser serializado para ou do.  
  
 `dwVersionDefault`  
 O número de versão atual do controle.  
  
 `bConvert`  
 Indica se os dados persistentes devem ser convertidos para o formato mais recente quando ele for salvo ou mantido no mesmo formato que tinha quando foi carregado.  
  
### <a name="return-value"></a>Valor de retorno  
 O número de versão do controle. Se o arquivo especificado está carregando, `SerializeVersion` retorna a versão carregada a partir desse arquivo. Caso contrário, ele retorna a versão atualmente carregada.  
  
### <a name="remarks"></a>Comentários  
 Você pode melhorar o desempenho de persistência binário do controle usando `SerializeVersion`, `SerializeExtent`, e `SerializeStockProps` para substituir **COleControl::Serialize**. Para obter um exemplo, consulte o código em [SerializeExtent](#serializeextent). Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: otimização](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="setappearance"></a>COleControl::SetAppearance  
 Define o valor da propriedade Appearance estoque de seu controle.  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>Parâmetros  
 *sAppearance*  
 Um **curto** ( `VT_I2`) valor a ser usado para a aparência de seu controle. Um valor de zero define a aparência do controle para simples e um valor de 1 define a aparência do controle para 3D.  
  
### <a name="remarks"></a>Comentários  
 Para obter mais informações sobre propriedades de estoque, consulte [controles ActiveX: propriedades](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setbackcolor"></a>COleControl::SetBackColor  
 Define o valor da propriedade BackColor estoque de seu controle.  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>Parâmetros  
 *dwBackColor*  
 Um **OLE_COLOR** valor a ser usado para o plano de fundo do controle de desenho.  
  
### <a name="remarks"></a>Comentários  
 Para obter mais informações sobre como usar essa propriedade e outras propriedades relacionadas, consulte o artigo [controles ActiveX: propriedades](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setborderstyle"></a>COleControl::SetBorderStyle  
 Define o valor da propriedade BorderStyle estoque de seu controle.  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>Parâmetros  
 *sBorderStyle*  
 O novo estilo de borda do controle; 0 não indica que nenhuma borda e 1 indica uma borda normal.  
  
### <a name="remarks"></a>Comentários  
 A janela de controle, em seguida, será recriada e `OnBorderStyleChanged` chamado.  
  
##  <a name="setcapture"></a>COleControl::SetCapture  
 Faz com que a janela do controle recipiente tomar posse da captura do mouse no nome do controle.  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Um ponteiro para o **CWnd** objeto window que recebeu a entrada do mouse.  
  
### <a name="remarks"></a>Comentários  
 Se o controle está ativada e sem janelas, essa função faz com que a janela do controle recipiente tomar posse da captura do mouse no nome do controle. Caso contrário, essa função faz com que o controle para tomar posse da captura do mouse (mesmo que `CWnd::SetCapture`).  
  
##  <a name="setcontrolsize"></a>COleControl::SetControlSize  
 Define o tamanho da janela de controle OLE e notifica o contêiner que o site do controle é alterado.  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>Parâmetros  
 `cx`  
 Especifica a nova largura do controle em pixels.  
  
 `cy`  
 Especifica a nova altura do controle em pixels.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se a chamada foi bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Essa função não deve ser usada no construtor do controle.  
  
 Observe que todas as coordenadas do windows de controle em relação ao canto superior esquerdo do controle.  
  
##  <a name="setenabled"></a>COleControl::SetEnabled  
 Define o valor da propriedade Enabled do controle de estoque.  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>Parâmetros  
 `bEnabled`  
 **TRUE** se o controle estiver habilitado; caso contrário **FALSE**.  
  
### <a name="remarks"></a>Comentários  
 Depois de definir essa propriedade, **OnEnabledChange** é chamado.  
  
##  <a name="setfocus"></a>COleControl::SetFocus  
 Faz com que a janela do controle recipiente tomar posse do foco de entrada em nome do controle.  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>Valor de retorno  
 Um ponteiro para o **CWnd** objeto window que anteriormente tinha o foco de entrada, ou **nulo** se não houver nenhuma janela.  
  
### <a name="remarks"></a>Comentários  
 Se o controle está ativada e sem janelas, essa função faz com que a janela do controle recipiente tomar posse do foco de entrada, em nome do controle. O foco de entrada direciona a entrada do teclado para a janela do contêiner e o contêiner envia todas as mensagens de teclado subsequentes para o objeto OLE que chama `SetFocus`. Perde qualquer janela que anteriormente tinha o foco de entrada.  
  
 Se o controle não está sem janelas, essa função faz com que o controle para tomar posse do foco de entrada (mesmo que `CWnd::SetFocus`).  
  
##  <a name="setfont"></a>COleControl::SetFont  
 Define a propriedade de fonte de estoque de seu controle.  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>Parâmetros  
 *pFontDisp*  
 Um ponteiro para uma interface de expedição de fonte.  
  
##  <a name="setforecolor"></a>COleControl::SetForeColor  
 Define o valor da propriedade ForeColor estoque de seu controle.  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>Parâmetros  
 *dwForeColor*  
 Um **OLE_COLOR** valor a ser usado para o primeiro plano do controle de desenho.  
  
### <a name="remarks"></a>Comentários  
 Para obter mais informações sobre como usar essa propriedade e outras propriedades relacionadas, consulte o artigo [controles ActiveX: propriedades](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats  
 Chamado pelo framework para inicializar a lista de formatos de dados suportados pelo controle.  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>Comentários  
 A implementação padrão especifica dois formatos: `CF_METAFILEPICT` e a propriedade persistente definida.  
  
##  <a name="setinitialsize"></a>COleControl::SetInitialSize  
 Define o tamanho de um controle OLE quando exibida pela primeira vez em um contêiner.  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>Parâmetros  
 `cx`  
 A largura inicial do controle OLE em pixels.  
  
 `cy`  
 A altura inicial do controle OLE em pixels.  
  
### <a name="remarks"></a>Comentários  
 Chame essa função em seu construtor para definir o tamanho inicial do controle. O tamanho inicial é medido em unidades de dispositivo ou pixels. É recomendável que essa chamada feita no construtor do controle.  
  
##  <a name="setmodifiedflag"></a>COleControl::SetModifiedFlag  
 Altera o estado modificado de um controle.  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>Parâmetros  
 `bModified`  
 O novo valor para o controle modificada do sinalizador. **TRUE** indica que o estado do controle foi modificado; **FALSE** indica que apenas o estado do controle foi salvo.  
  
### <a name="remarks"></a>Comentários  
 Essa função sempre que ocorre uma alteração que afetam o estado persistente do controle de chamada. Por exemplo, se o valor de uma propriedade persistente é alterado, chame essa função com `bModified` **TRUE**.  
  
##  <a name="setnotpermitted"></a>COleControl::SetNotPermitted  
 Indica que uma solicitação de edição falhou.  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>Comentários  
 Chamar essa função quando `BoundPropertyRequestEdit` falhar. Essa função lança uma exceção do tipo **COleDispScodeException** para indicar que a operação não foi permitida.  
  
##  <a name="setnotsupported"></a>COleControl::SetNotSupported  
 Impede a modificação de valor de propriedade do controle do usuário.  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>Comentários  
 Chame essa função em vez da função de conjunto de qualquer propriedade que não há suporte para modificação do valor da propriedade de usuário do controle. Um exemplo seria uma propriedade que é somente leitura.  
  
##  <a name="setrectincontainer"></a>COleControl::SetRectInContainer  
 Define as coordenadas do retângulo de controle em relação ao contêiner, expressado em unidades de dispositivo.  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parâmetros  
 `lpRect`  
 Um ponteiro para um retângulo que contém novas coordenadas do controle em relação ao contêiner.  
  
### <a name="return-value"></a>Valor de retorno  
 Diferente de zero se a chamada foi bem-sucedida; Caso contrário, 0.  
  
### <a name="remarks"></a>Comentários  
 Se o controle estiver aberto, ele é redimensionado; Caso contrário, o contêiner **OnPosRectChanged** função é chamada.  
  
##  <a name="settext"></a>COleControl::SetText  
 Define o valor da propriedade estoque de legenda ou o texto do controle.  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>Parâmetros  
 `pszText`  
 Um ponteiro para uma cadeia de caracteres.  
  
### <a name="remarks"></a>Comentários  
 Observe que as propriedades de estoque legenda e texto são mapeadas para o mesmo valor. Isso significa que as alterações feitas em qualquer propriedade vai alterar automaticamente as duas propriedades. Em geral, um controle deve oferecer suporte o legenda de estoque ou propriedade de texto, mas não ambos.  
  
##  <a name="throwerror"></a>COleControl::ThrowError  
 Indica a ocorrência de um erro no seu controle.  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Parâmetros  
 `sc`  
 O valor de código de status a ser relatado. Para obter uma lista completa de possíveis códigos, consulte o artigo [controles ActiveX: tópicos avançados](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `nDescriptionID`  
 A ID de recurso de cadeia de caracteres da exceção sejam relatados.  
  
 `nHelpID`  
 A ID do tópico da ajuda a ser relatado no.  
  
 `pszDescription`  
 Uma cadeia de caracteres que contém uma explicação da exceção sejam relatados.  
  
### <a name="remarks"></a>Comentários  
 Essa função só deve ser chamada de dentro de uma função Get ou Set de uma propriedade OLE ou a implementação de um método de automação OLE. Se você precisar sinalizar erros que ocorrem em outros momentos, você deve acionar o evento de erro de estoque.  
  
##  <a name="transformcoords"></a>COleControl::TransformCoords  
 Transformações coordenam os valores entre **HIMETRIC** unidades e unidades nativas do contêiner.  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>Parâmetros  
 *lpptlHimetric*  
 Ponteiro para um **POINTL** estrutura que contém as coordenadas em **HIMETRIC** unidades.  
  
 *lpptfContainer*  
 Ponteiro para um **POINTF** estrutura que contém as coordenadas de tamanho de unidade do contêiner.  
  
 `flags`  
 Uma combinação dos seguintes valores:  
  
- **XFORMCOORDS_POSITION** uma posição no contêiner.  
  
- **XFORMCOORDS_SIZE** um tamanho no contêiner.  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER** transformação **HIMETRIC** unidades para unidades do contêiner.  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC** transformação unidades do contêiner para **HIMETRIC** unidades.  
  
### <a name="remarks"></a>Comentários  
 Os primeiros dois sinalizadores, **XFORMCOORDS_POSITION** e **XFORMCOORDS_SIZE**, indique se as coordenadas devem ser tratadas como uma posição ou um tamanho. Os dois sinalizadores restantes indicam a direção da transformação.  
  
##  <a name="translatecolor"></a>COleControl::TranslateColor  
 Converte um valor de cor do **OLE_COLOR** tipo de dados para o [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) tipo de dados.  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>Parâmetros  
 `clrColor`  
 Um **OLE_COLOR** tipo de dados. Para obter mais informações, consulte o Windows [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353) função.  
  
 `hpal`  
 Um identificador para uma paleta opcional; pode ser **nulo**.  
  
### <a name="return-value"></a>Valor de retorno  
 Um valor de 32 bits de cor RGB (vermelho, verde, azul) que define o sólido cor mais próximo a `clrColor` valor que pode representar o dispositivo.  
  
### <a name="remarks"></a>Comentários  
 Essa função é útil para converter as propriedades ForeColor e BackColor estoque para **COLORREF** tipos usados por [CDC](../../mfc/reference/cdc-class.md) funções de membro.  
  
##  <a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad  
 Determina se o controle deve usar os valores das propriedades de ambiente como valores padrão, quando ele é subsequentemente carregado do estado persistente.  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>Valor de retorno  
 NonZero indica que as propriedades do ambiente será válidas. Caso contrário, propriedades de ambiente não serão válidas.  
  
### <a name="remarks"></a>Comentários  
 Em alguns contêineres, o controle pode não ter acesso a suas propriedades de ambiente durante a chamada inicial para a substituição de `COleControl::DoPropExchange`. Esse é o caso se o contêiner chama [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) ou [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) antes de chamar [IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (ou seja, se ele não cumpre o **OLEMISC_SETCLIENTSITEFIRST** bits de status).  
  
##  <a name="windowproc"></a>COleControl::WindowProc  
 Fornece um procedimento do Windows para uma `COleControl` objeto.  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>Parâmetros  
 `message`  
 Especifica a mensagem do Windows a ser processado.  
  
 `wParam`  
 Fornece informações adicionais usadas no processamento da mensagem. O valor do parâmetro depende da mensagem.  
  
 `lParam`  
 Fornece informações adicionais usadas no processamento da mensagem. O valor do parâmetro depende da mensagem.  
  
### <a name="return-value"></a>Valor de retorno  
 O valor de retorno da mensagem enviada.  
  
### <a name="remarks"></a>Comentários  
 Chame essa função para enviar mensagens específicas por meio de mapa de mensagem do controle.  
  
## <a name="see-also"></a>Consulte também  
 [CIRC3 de exemplo do MFC](../../visual-cpp-samples.md)   
 [Exemplo MFC TESTHELP](../../visual-cpp-samples.md)   
 [Classe COlePropertyPage](../../mfc/reference/colepropertypage-class.md)   
 [Classe CWnd](../../mfc/reference/cwnd-class.md)   
 [Gráfico de hierarquia](../../mfc/hierarchy-chart.md)   
 [Classe CFontHolder](../../mfc/reference/cfontholder-class.md)   
 [Classe CPictureHolder](../../mfc/reference/cpictureholder-class.md)

